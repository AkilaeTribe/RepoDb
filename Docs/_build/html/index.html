
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Introduction to RepoDb &#8212; RepoDb 1.1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction-to-repodb">
<h1>Introduction to RepoDb<a class="headerlink" href="#introduction-to-repodb" title="Permalink to this headline">¶</a></h1>
<p>A dynamic ORM .NET Library used to create an entity-based repository classes when accessing data from the database.</p>
<div class="section" id="goal">
<h2>Goal<a class="headerlink" href="#goal" title="Permalink to this headline">¶</a></h2>
<p>We aim to let .NET developers limit the implementation of SQL Statements within the application.</p>
<p>We believe that as a .NET developer, one should only focus on .NET and Business scenario development and not on writing repetitive SQL Statements.</p>
<p>Of course, unless you are working closely with SQL Server Management Studio.</p>
</div>
<div class="section" id="principles">
<h2>Principles<a class="headerlink" href="#principles" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>We will keep it simple as possible (KISS principle)</li>
<li>We will make it fast as possible</li>
<li>We will never make complex implementations (specially for Queries and Methods)</li>
<li>We will avoid developing complex JOINs (until it is needed and requested by the community)</li>
<li>We will never ever do try-catch inside the library</li>
<li>We will help developers to be more focus on SOLID principle</li>
</ul>
</div>
<div class="section" id="why-repodb">
<h2>Why RepoDb?<a class="headerlink" href="#why-repodb" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Operations (Asynchronous)</li>
<li>Type Mapping</li>
<li>Field Mapping</li>
<li>Multiple Mapping</li>
<li>Expression Tree</li>
<li>Caching</li>
<li>Tracing</li>
<li>SQL Statement Builder</li>
<li>Transactions</li>
</ul>
</div>
</div>
<div class="section" id="installation-steps">
<h1>Installation Steps<a class="headerlink" href="#installation-steps" title="Permalink to this headline">¶</a></h1>
<p>There are two ways of installing the library as standardized by Microsoft. First, via Nuget Package Manager, and secondly, via Package Manager Console.</p>
<p><strong>Pre-requisite</strong>: A Microsoft Visual Studio has already been installed and a Project Solution has already been created.</p>
<div class="section" id="via-nuget-package-manager">
<h2>Via Nuget Package Manager<a class="headerlink" href="#via-nuget-package-manager" title="Permalink to this headline">¶</a></h2>
<p>Once the project solution is open, then do the following steps.</p>
<ol class="arabic simple">
<li>Right click on the solution and click the <cite>Manage Nuget Packages for Solution…</cite>.</li>
<li>Select the <cite>Browse</cite> tab.</li>
<li>In the <cite>Search</cite> field, type <cite>RepoDb</cite> and press <cite>Enter</cite>.</li>
<li>In the right side, select the project you wish the library to install to.</li>
<li>Click the <cite>Install</cite> button.</li>
</ol>
<p>Wait for few seconds until the installation is completed.</p>
</div>
<div class="section" id="via-package-manager-console">
<h2>Via Package Manager Console<a class="headerlink" href="#via-package-manager-console" title="Permalink to this headline">¶</a></h2>
<p>Once the project solution is open, then do the following steps.</p>
<ol class="arabic simple">
<li>Select the <cite>View -&gt; Other Windows -&gt; Package Manager Console</cite>.</li>
<li>In the <cite>Package Source</cite> drop down field, select <cite>All</cite>.</li>
<li>In the <cite>Default Project</cite> drop down field, select the project you wish the library to install to.</li>
<li>In the <cite>Package Manager Console</cite>, type the <cite>Install-Package RepoDb</cite>, then press <cite>Enter</cite>.</li>
</ol>
<p>Wait for few seconds until the installation is completed.</p>
</div>
</div>
<div class="section" id="creating-a-dataentity">
<h1>Creating a DataEntity<a class="headerlink" href="#creating-a-dataentity" title="Permalink to this headline">¶</a></h1>
<p>A <cite>DataEntity</cite> is a DTO class used to feed the operations of the repositories. It acts as a single row when it comes to database.</p>
<p>It is recommended that an explicit interface (of type <cite>RepoDb.Interfaces.IDataEntity</cite>) must be implemented in order to make a contracted <cite>DataEntity</cite>.</p>
<div class="section" id="dataentity-class">
<h2>DataEntity Class<a class="headerlink" href="#dataentity-class" title="Permalink to this headline">¶</a></h2>
<p>Acts as the base class of all <cite>Data Entity</cite> object. Located at <cite>RepoDb</cite> namespace.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">ClassName</span> <span class="p">:</span> <span class="n">DataEntity</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="idataentity-interface">
<h2>IDataEntity Interface<a class="headerlink" href="#idataentity-interface" title="Permalink to this headline">¶</a></h2>
<p>An interface used to implement to mark a class to be the base class of all <cite>Data Entity</cite> object. Located at <cite>RepoDb.Interfaces</cite> namespace.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">interface</span> <span class="n">IClassName</span> <span class="p">:</span> <span class="n">IDataEntity</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mapping-with-mapattribute">
<h1>Mapping with MapAttribute<a class="headerlink" href="#mapping-with-mapattribute" title="Permalink to this headline">¶</a></h1>
<p>A <cite>MapAttribute</cite> is used to define a mapping of the current <cite>Class</cite> or <cite>Property</cite> equivalent to an <cite>Object</cite> or <cite>Field</cite> name in the database. Located at <cite>RepoDb.Attributes</cite> namespace.</p>
<p>The <cite>Map</cite> attribute second parameter is a command type <cite>of type System.Data.CommandType</cite>. If this parameter is defined, the repository operation execution will then be of that command type. This parameter is only working at the class level implementation.</p>
<p>See Microsoft documentation for <a class="reference external" href="https://msdn.microsoft.com/en-us/library/system.data.commandtype%28v=vs.110%29.aspx">System.Data.CommandType</a> here.</p>
<div class="section" id="mapping-a-class">
<h2>Mapping a Class<a class="headerlink" href="#mapping-a-class" title="Permalink to this headline">¶</a></h2>
<p>By default, the name of the class is used as a default mapped object from the database. However, if the database object name is different from the class name, the <cite>MapAttribute</cite> is then use to map it properly.</p>
<p>Below is a sample code that maps the class named <cite>EmployeeDto</cite> into <cite>Employee</cite> table from the database.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="na">[Map(&quot;[dbo]</span><span class="p">.[</span><span class="n">Employee</span><span class="p">]</span><span class="s">&quot;, CommandType.Text)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">EmployeeDto</span> <span class="p">:</span> <span class="n">DataEntity</span>
<span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="mapping-a-property">
<h2>Mapping a Property<a class="headerlink" href="#mapping-a-property" title="Permalink to this headline">¶</a></h2>
<p>By default, the name of the property is used as a default mapped field from the database object (table, view or any result set). However, if the database field name is different from the property name, the <cite>MapAttribute</cite> is then use to map it properly.</p>
<p>Below is a sample code that maps the property named <cite>Id</cite> into a <cite>EmployeeId</cite> field <cite>Employee</cite> table from the database.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="na">[Map(&quot;[dbo]</span><span class="p">.[</span><span class="n">Employee</span><span class="p">]</span><span class="s">&quot;, CommandType.Text)]</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">EmployeeDto</span> <span class="p">:</span> <span class="n">DataEntity</span>
<span class="p">{</span>
<span class="na">        [Map(&quot;EmployeeId&quot;)]</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="primary-attribute">
<h1>Primary Attribute<a class="headerlink" href="#primary-attribute" title="Permalink to this headline">¶</a></h1>
<p>A <cite>PrimaryAttribute</cite> is used to define the class property as primary property of the <cite>DataEntity</cite> object. Located at <cite>RepoDb.Attributes</cite> namespace.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">Employee</span> <span class="p">:</span> <span class="n">DataEntity</span>
<span class="p">{</span>
<span class="na">        [Primary]</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="defining-an-identity-property">
<h2>Defining an Identity Property<a class="headerlink" href="#defining-an-identity-property" title="Permalink to this headline">¶</a></h2>
<p>To define an identity property, simply sets the <cite>isIdentity</cite> parameter of the <cite>PrimaryAttribute</cite> during the implementation.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">Employee</span> <span class="p">:</span> <span class="n">DataEntity</span>
<span class="p">{</span>
<span class="na">        [Primary(true)]</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ignore-attribute">
<h1>Ignore Attribute<a class="headerlink" href="#ignore-attribute" title="Permalink to this headline">¶</a></h1>
<p>An <cite>IgnoreAttribute</cite> is used to mark a class property to be ignoreable during the actual repository operation. Located at <cite>RepoDb.Attributes</cite> namespace.</p>
<p>Example: If of type command <cite>Insert</cite> and <cite>Update</cite> is defined on the <cite>IgnoreAttribute</cite> of the class property named <cite>CreatedDate</cite>, then the property will not be a part of the <cite>Insert</cite> and <cite>Update</cite> operation of the repository.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">Employee</span> <span class="p">:</span> <span class="n">DataEntity</span>
<span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

<span class="na">        [Ignore(Command.Insert | Command.Update)]</span>
        <span class="k">public</span> <span class="n">DateTime</span> <span class="n">CreatedDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below are the commands that can be defined using the <cite>IgnoreAttribute</cite>.</p>
<ul class="simple">
<li>None</li>
<li>Query</li>
<li>Insert</li>
<li>Update</li>
<li>Delete</li>
<li>Merge</li>
<li>BatchQuery</li>
<li>InlineUpdate</li>
</ul>
</div>
<div class="section" id="multiple-entity-mapping">
<h1>Multiple Entity Mapping<a class="headerlink" href="#multiple-entity-mapping" title="Permalink to this headline">¶</a></h1>
<p>This feature is a unique built-in feature of the library that enables the developer to do multiple mapping on a <cite>DataEntity</cite> object into multiple object in the database. This is very usable for some complex requirements that includes like the implementations of <cite>Table</cite>, <cite>Views</cite> and <cite>StoredProcedures</cite> must be mapped into one <cite>DataEntity</cite> object.</p>
<p>The class named <cite>RepoDb.DataEntityMapper</cite> is used when doing a multiple mapping. Below are the methods.</p>
<ul class="simple">
<li><strong>For</strong>: used to create a mapping between the data entity and database object. Returns an <cite>RepoDb.DataEntityMapItem</cite> object.</li>
</ul>
<p>The class named <cite>RepoDb.DataEntityMapItem</cite> is used to map the operation level of the repository into the database object. Below are the methods.</p>
<ul class="simple">
<li><strong>On</strong>: used to map on which repository command operation and database object the mapping is implemented.</li>
<li><strong>Set</strong>: used to set the repository command operation data entity mapping definition. This is the underlying method being called by <cite>On</cite> method.</li>
<li><strong>Get</strong>: get the entity mapping definition defined on the repository command operation.</li>
</ul>
<p>Multi-mapping is bound in an operation-level of the repository. This means that the developer can map the <cite>Query</cite> operation of a <cite>Customer</cite> object into <cite>[dbo].[Customer]</cite> table of the database, whereas the <cite>Delete</cite> operation is mapped into <cite>[dbo].[sp_DeleteCustomer]</cite> database object.</p>
<p>Let say a <cite>Customer</cite> entity object was created in the solution, and the following database objects exist.</p>
<blockquote>
<div><ul class="simple">
<li>A table named <cite>Customer</cite>.</li>
<li>A stored procedure named <cite>sp_DeleteCustomer</cite>.</li>
<li>A stored procedure named <cite>sp_InsertCustomer</cite>, where the logic inside of is joining from different database tables.</li>
<li>A view named <cite>vw_Customer</cite>.</li>
</ul>
</div></blockquote>
<p>Developers can simply call the mapper methods when mapping a <cite>Customer</cite> object into these database objects.</p>
<p>Below are the codes for multiple mapping.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">DataEntityMapper</span><span class="p">.</span><span class="n">For</span><span class="p">&lt;</span><span class="n">Stock</span><span class="p">&gt;()</span>
        <span class="p">.</span><span class="n">On</span><span class="p">(</span><span class="n">Command</span><span class="p">.</span><span class="n">Insert</span><span class="p">,</span> <span class="s">&quot;[dbo].[sp_QueryCustomer]&quot;</span><span class="p">,</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">)</span>
        <span class="p">.</span><span class="n">On</span><span class="p">(</span><span class="n">Command</span><span class="p">.</span><span class="n">Delete</span><span class="p">,</span> <span class="s">&quot;[dbo].[sp_DeleteCustomer]&quot;</span><span class="p">,</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">)</span>
        <span class="p">.</span><span class="n">On</span><span class="p">(</span><span class="n">Command</span><span class="p">.</span><span class="n">Query</span><span class="p">,</span> <span class="s">&quot;[dbo].[vw_Customer]&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="n">On</span><span class="p">(</span><span class="n">Command</span><span class="p">.</span><span class="n">Update</span><span class="p">,</span> <span class="s">&quot;[dbo].[Customer]&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="n">On</span><span class="p">(</span><span class="n">Command</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">,</span> <span class="s">&quot;[dbo].[Customer]&quot;</span><span class="p">,</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">TableDirect</span><span class="p">);</span>
</pre></div>
</div>
<p>These feature has its own limitations. All mappings could not be done on every command (i.e Count, CountBig, Merge, ExecuteQuery, ExecuteNonQuery, ExecuteReader, ExecuteScalar).</p>
<p>Below are the supported mapping for each command.</p>
<ul class="simple">
<li><strong>BatchQuery</strong>: only for a database Table and <cite>CommandType.Text</cite>.</li>
<li><strong>Count</strong>: only for a database Table and <cite>CommandType.Text</cite>.</li>
<li><strong>CountBig</strong>: only for a database Table and <cite>CommandType.Text</cite>.</li>
<li><strong>InlineUpdate</strong>: only for a database Table and <cite>CommandType.Text</cite>.</li>
<li><strong>Merge</strong>: only for a database Table and <cite>CommandType.Text</cite>.</li>
<li><strong>BulkInsert</strong>: only for a database Table and <cite>CommandType.&lt;Text | TableDirect&gt;</cite>.</li>
<li><strong>Insert</strong>: full support.</li>
<li><strong>Delete</strong>: full support.</li>
<li><strong>Query</strong>: full support.</li>
<li><strong>Update</strong>: full support.</li>
</ul>
<p>Attempt to map to a wrong command would throw an <cite>System.InvalidOperationException</cite> back to the caller.</p>
</div>
<div class="section" id="type-mapping">
<h1>Type Mapping<a class="headerlink" href="#type-mapping" title="Permalink to this headline">¶</a></h1>
<p>Type mapping is feature that allows the library to identify which type of .NET is equivalent to the <cite>System.Data.DbType</cite> types. This feature is important to force the library the conversion it will going to specially when running the repository operations.</p>
<p>Below is the way on how to map the <cite>System.DateTime</cite> to be equivalent as <cite>System.Data.DbType.DateTime2</cite>.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">TypeMapper</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">DateTime</span><span class="p">),</span> <span class="n">DbType</span><span class="p">.</span><span class="n">DateTime2</span><span class="p">);</span>
</pre></div>
</div>
<p>and <cite>System.Decimal</cite> into <cite>System.Data.DbType.Double</cite>.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">TypeMapper</span><span class="p">.</span><span class="n">AddMap</span><span class="p">(</span><span class="k">new</span> <span class="n">TypeMap</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Decimal</span><span class="p">),</span> <span class="n">DbType</span><span class="p">.</span><span class="n">Double</span><span class="p">));</span>
</pre></div>
</div>
<p><strong>Note</strong>: The class is callable anywhere in the application as it was implemented in a static way.</p>
</div>
<div class="section" id="working-wth-repository">
<h1>Working wth Repository<a class="headerlink" href="#working-wth-repository" title="Permalink to this headline">¶</a></h1>
<p>The library contains two repository objects, the <cite>RepoDb.BaseRepository&lt;TEntity, TDbConnection&gt;</cite> and the <cite>RepoDb.DbRepository&lt;TDbConnection&gt;</cite>.</p>
<p>The latter is the heart of the library as it contains all the operations that is being used by all other repositories within or outside the library.</p>
<div class="section" id="dbrepository-class">
<h2>DbRepository Class<a class="headerlink" href="#dbrepository-class" title="Permalink to this headline">¶</a></h2>
<p>A base object for all shared-based repositories. This object is usually being inheritted if the derived class is meant for shared-based operations. This object is used by <cite>RepoDb.BaseRepository&lt;TEntity, TDbConnection&gt;</cite> as an underlying repository for all of its operations. Located at <cite>RepoDb</cite> namespace.</p>
<p>This means that, the <cite>RepoDb.BaseRepository&lt;TEntity, TDbConnection&gt;</cite> is only abstracting the operations of the <cite>RepoDb.DbRepository&lt;TDbConnection&gt;</cite> object in all areas.</p>
<p>Below are the constructor parameters:</p>
<ul class="simple">
<li><strong>connectionString</strong>: the connection string to connect to.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds. It is being used to set the value of the <cite>DbCommand.CommandTimeout</cite> object prior to the execution of the operation.</li>
<li><strong>cache (optional)</strong>: the cache object to be used by the repository. By default, the repository is using the <cite>RepoDb.MemoryCache</cite> object.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by the repository. The default is <cite>null</cite>.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by the repository. By default, the repository is using the <cite>RepoDb.SqlDbStatementBuilder</cite> object.</li>
</ul>
<p>This repository can be instantiated directly or indirectly. Indirectly means, it should be abstracted first before instantiation.</p>
<p>See sample code below on how to directly create a <cite>DbRepository</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Another way of creating a <cite>DbRepository</cite> is by abstracting it through derived classes. See sample code below.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">NorthwindDbRepository</span> <span class="p">:</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;</span>
        <span class="k">base</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, call it somewhere.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NorthwindRepository</span><span class="p">();</span>
</pre></div>
</div>
<p>It is recommended to create a contracted interface for <cite>DbRepository</cite> in order for it to be dependency injectable.</p>
<p>See sample code below the way on how to create an interface and implement it directly to the derived class.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">interface</span> <span class="n">INorthwindDbRepository</span> <span class="p">:</span> <span class="n">IDbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">NorthwindDbRepository</span> <span class="p">:</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;,</span> <span class="n">INorthwindDbRepository</span>
        <span class="k">base</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="baserepository-class">
<h2>BaseRepository Class<a class="headerlink" href="#baserepository-class" title="Permalink to this headline">¶</a></h2>
<p>An abstract class for all entity-based repositories. This object is usually being inheritted if the derived class is meant for entity-based operations. Located at <cite>RepoDb</cite> namespace.</p>
<p>The operational scope of this repository is only limited to its defined target <cite>DataEntity</cite> object.</p>
<p>Below are the constructor parameters:</p>
<ul class="simple">
<li><strong>connectionString</strong>: the connection string to connect to.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds. It is being used to set the value of the <cite>DbCommand.CommandTimeout</cite> object prior to the execution of the operation.</li>
<li><strong>cache (optional)</strong>: the cache object to be used by the repository. By default, the repository is using the <cite>RepoDb.MemoryCache</cite> object.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by the repository. The default is <cite>null</cite>.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by the repository. By default, the repository is using the <cite>RepoDb.SqlDbStatementBuilder</cite> object.</li>
</ul>
<p>See sample code below on how to directly create a <cite>DbRepository</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">CustomerRepository</span> <span class="p">:</span> <span class="n">BaseRepository</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">SqlConnection</span><span class="p">&gt;</span>
        <span class="k">base</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, call it somewhere.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CustomerRepository</span><span class="p">();</span>
</pre></div>
</div>
<p>It is recommended to create a contracted interface for <cite>BaseRepository</cite> in order for it to be dependency injectable.</p>
<p>See sample code below the way on how to create an interface and implement it directly to the derived class.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">interface</span> <span class="n">ICustomerRepository</span> <span class="p">:</span> <span class="n">IBaseRepository</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">SqlConnection</span><span class="p">&gt;</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">CustomerRepository</span> <span class="p">:</span> <span class="n">BaseRepository</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">SqlConnection</span><span class="p">&gt;,</span> <span class="n">ICustomerRepository</span>
        <span class="k">base</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-connection">
<h2>Creating a Connection<a class="headerlink" href="#creating-a-connection" title="Permalink to this headline">¶</a></h2>
<p>A repository is used to create a connection object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Use the connection here</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="connection-ensureopen">
<h2>Connection.EnsureOpen<a class="headerlink" href="#connection-ensureopen" title="Permalink to this headline">¶</a></h2>
<p>This method is used to ensure that the connection object is <cite>Open</cite>. The repository operations are calling this method explicitly prior to the actual execution. This method returns the connection instance itself.</p>
<p>The underlying method call of this method is the <cite>System.Data.DbConnection.Open()</cite> method.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">().</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// No need to open the connection</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="connection-executereader">
<h2>Connection.ExecuteReader<a class="headerlink" href="#connection-executereader" title="Permalink to this headline">¶</a></h2>
<p>This connection extension method is use to execute a SQL statement query from the database in fast-forward access. This method returns an instance of <cite>System.Data.IDataReader</cite> object.</p>
<p>The underlying method call of this method is the <cite>System.Data.IDbCommand.ExecuteReader()</cite> method.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">().</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM [dbo].[Customer] WHERE (Id &lt;= @Id);&quot;</span><span class="p">;</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10000</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
                <span class="p">{</span>
                        <span class="c1">// Process the records here</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: the SQL statement to be used for execution.</li>
<li><strong>param</strong>: the parameters to be used for the execution. It could be an entity class or a dynamic object.</li>
<li><strong>commandTimeout</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>commandType</strong>: the type of command to be used whether it is a <cite>Text</cite>, <cite>StoredProcedure</cite> or <cite>TableDirect</cite>.</li>
<li><strong>transaction</strong>: the transaction object be used when executing the command.</li>
<li><strong>trace</strong>: the trace object to be used on this operation.</li>
</ul>
</div>
<div class="section" id="connection-executequery">
<h2>Connection.ExecuteQuery<a class="headerlink" href="#connection-executequery" title="Permalink to this headline">¶</a></h2>
<p>This connection extension method is use to execute a SQL statement query from the database in fast-forward access. It returns an enumerable list of <cite>dynamic</cite> or <cite>RepoDb.Interfaces.IDataEntity</cite> object.</p>
<p>The underlying method call of this method is the <cite>System.Data.IDbCommand.ExecuteReader()</cite> method.</p>
<p>Code below returns an enumerable list of <cite>dynamic</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">().</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM [dbo].[Customer] WHERE (Id &lt;= @Id);&quot;</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10000</span> <span class="p">}))</span>
        <span class="n">customers</span>
                <span class="p">.</span><span class="n">ToList</span><span class="p">()</span>
                <span class="p">.</span><span class="n">ForEach</span><span class="p">(</span><span class="n">customer</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                        <span class="c1">// Process each customer here</span>
                <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Code below returns an enumerable list of <cite>Customer</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">().</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM [dbo].[Customer] WHERE (Id &lt;= @Id);&quot;</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10000</span> <span class="p">}))</span>
        <span class="n">customers</span>
                <span class="p">.</span><span class="n">ToList</span><span class="p">()</span>
                <span class="p">.</span><span class="n">ForEach</span><span class="p">(</span><span class="n">customer</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                        <span class="c1">// Process each customer here</span>
                <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: the SQL statement to be used for execution.</li>
<li><strong>param</strong>: the parameters to be used for the execution. It could be an entity class or a dynamic object.</li>
<li><strong>commandTimeout</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>commandType</strong>: the type of command to be used whether it is a <cite>Text</cite>, <cite>StoredProcedure</cite> or <cite>TableDirect</cite>.</li>
<li><strong>transaction</strong>: the transaction object be used when executing the command.</li>
<li><strong>trace</strong>: the trace object to be used on this operation.</li>
</ul>
</div>
<div class="section" id="connection-executenonquery">
<h2>Connection.ExecuteNonQuery<a class="headerlink" href="#connection-executenonquery" title="Permalink to this headline">¶</a></h2>
<p>This connection extension method is used to execute a non-queryable SQL statement. It returns an <cite>int</cite> that holds the number of affected rows during the execution.</p>
<p>The underlying method call of this method is the <cite>System.Data.IDbCommand.ExecuteNonQuery()</cite> method.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">().</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;UPDATE [dbo].[Customer] SET Name = @Name WHERE (Id = @Id);&quot;</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span>  <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10000</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Anna Fullerton&quot;</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: the SQL statement to be used for execution.</li>
<li><strong>param</strong>: the parameters to be used for the execution. It could be an entity class or a dynamic object.</li>
<li><strong>commandTimeout</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>commandType</strong>: the type of command to be used whether it is a <cite>Text</cite>, <cite>StoredProcedure</cite> or <cite>TableDirect</cite>.</li>
<li><strong>transaction</strong>: the transaction object be used when executing the command.</li>
<li><strong>trace</strong>: the trace object to be used on this operation.</li>
</ul>
</div>
<div class="section" id="connection-executescalar">
<h2>Connection.ExecuteScalar<a class="headerlink" href="#connection-executescalar" title="Permalink to this headline">¶</a></h2>
<p>This connection extension method is used to execute a query statement that returns single value of type <cite>System.Object</cite>.</p>
<p>The underlying method call of this method is the <cite>System.Data.IDbCommand.ExecuteScalar()</cite> method.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">().</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT MAX(Id) FROM [dbo].[Customer];&quot;</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">customerMaxId</span> <span class="p">=</span>  <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">(</span><span class="n">commandText</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: the SQL statement to be used for execution.</li>
<li><strong>param</strong>: the parameters to be used for the execution. It could be an entity class or a dynamic object.</li>
<li><strong>commandTimeout</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>commandType</strong>: the type of command to be used whether it is a <cite>Text</cite>, <cite>StoredProcedure</cite> or <cite>TableDirect</cite>.</li>
<li><strong>transaction</strong>: the transaction object be used when executing the command.</li>
<li><strong>trace</strong>: the trace object to be used on this operation.</li>
</ul>
</div>
<div class="section" id="working-with-storedprocedure">
<h2>Working with StoredProcedure<a class="headerlink" href="#working-with-storedprocedure" title="Permalink to this headline">¶</a></h2>
<p>Calling a stored procedure is a simple as a     executing any SQL Statements via repository, and by setting the <cite>CommandType</cite> to <cite>StoredProcedure</cite>.</p>
<p>Say a Stored Procedure below exists in the database.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_GetCustomer</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_GetCustomer</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">Id</span> <span class="nb">BIGINT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>

        <span class="k">SELECT</span> <span class="n">Id</span>
                <span class="p">,</span> <span class="n">Name</span>
                <span class="p">,</span> <span class="n">Title</span>
                <span class="p">,</span> <span class="n">UpdatedDate</span>
                <span class="p">,</span> <span class="n">CreatedDate</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Customer</span><span class="p">]</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="n">Id</span> <span class="o">=</span> <span class="o">@</span><span class="n">Id</span><span class="p">);</span>

<span class="k">END</span>
</pre></div>
</div>
<p>Below is the way on how to call the Stored Procedure.</p>
<p>Calling via <cite>Repository.ExecuteQuery</cite>.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="s">&quot;[dbo].[sp_GetCustomer]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
<span class="n">customers</span>
        <span class="p">.</span><span class="n">ToList</span><span class="p">()</span>
        <span class="p">.</span><span class="n">ForEach</span><span class="p">(</span><span class="n">customer</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
                <span class="c1">// Process each customer here</span>
        <span class="p">});</span>
</pre></div>
</div>
<p>Or, via independent <cite>SqlConnection</cite> object extended <cite>ExecuteQuery</cite> method.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">))</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="s">&quot;[dbo].[sp_GetCustomer]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
        <span class="n">customers</span>
                <span class="p">.</span><span class="n">ToList</span><span class="p">()</span>
                <span class="p">.</span><span class="n">ForEach</span><span class="p">(</span><span class="n">customer</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                        <span class="c1">// Process each customer here</span>
                <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Or, via <cite>Repository.ExecuteReader</cite>.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_GetCustomer]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">))</span>
<span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
        <span class="p">{</span>
                <span class="c1">// Process each row here</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Or, via independent <cite>SqlConnection</cite> object extended <cite>ExecuteReader</cite> method.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">))</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_GetCustomer]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">reader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span>
        <span class="p">{</span>
                <span class="c1">// Process each row here</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note</strong>: The multiple mapping also supports the Stored Procedure by binding it to the entity object.</p>
</div>
</div>
<div class="section" id="transaction">
<h1>Transaction<a class="headerlink" href="#transaction" title="Permalink to this headline">¶</a></h1>
<p>A transaction object works completely the same as it was with <cite>ADO.NET</cite>. The library only abstracted <cite>ADO.NET</cite> including the transaction objects.</p>
<p>Transactions can be created by calling the <cite>BeginTransaction</cite> method of the <cite>DbConnection</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">().</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">transaction</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BeginTransaction</span><span class="p">();</span>
        <span class="k">try</span>
        <span class="p">{</span>
                <span class="n">transaction</span><span class="p">.</span><span class="n">Commit</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">catch</span>
        <span class="p">{</span>
                <span class="n">transaction</span><span class="p">.</span><span class="n">Rollback</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">finally</span>
        <span class="p">{</span>
                <span class="n">transaction</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Every operation of the repository accepts a transaction object as an argument. Once passed, the transaction will become a part of the execution context. See below on how to commit a transaction context with multiple operations.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">connectionString</span> <span class="p">=</span> <span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">customerRepository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CustomerRepository</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="n">connectionString</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">orderRepository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OrderRepository</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">,</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="n">connectionString</span><span class="p">);</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="n">customerRepository</span><span class="p">.</span><span class="n">CreateConnection</span><span class="p">().</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">transaction</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BeginTransaction</span><span class="p">();</span>
        <span class="k">try</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="p">()</span>
                <span class="p">{</span>
                        <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Anna Fullerton&quot;</span><span class="p">,</span>
                        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
                <span class="p">};</span>
                <span class="kt">var</span> <span class="n">customerId</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt32</span><span class="p">(</span><span class="n">customerRepository</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">customer</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">transaction</span><span class="p">));</span>
                <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
                <span class="p">{</span>
                        <span class="n">CustomerId</span> <span class="p">=</span> <span class="n">customerId</span><span class="p">,</span>
                        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span><span class="p">,</span>
                        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
                <span class="p">};</span>
                <span class="kt">var</span> <span class="n">orderId</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt32</span><span class="p">(</span><span class="n">orderRepository</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">transaction</span><span class="p">:</span> <span class="n">transaction</span><span class="p">));</span>
                <span class="n">transaction</span><span class="p">.</span><span class="n">Commit</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">catch</span>
        <span class="p">{</span>
                <span class="n">transaction</span><span class="p">.</span><span class="n">Rollback</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">finally</span>
        <span class="p">{</span>
                <span class="n">transaction</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code snippets above will first insert a <cite>Customer</cite> record in the database and will return the newly added customer <cite>Id</cite>. It will be followed by inserting the <cite>Order</cite> record with the parent <cite>Customer.Id</cite> as part of the entity relationship. Then, the transaction will be committed. However, if any exception occurs during the operation, the transaction will rollback all the operations above.</p>
<p><strong>Note</strong>: Notice that the transaction object were created via <cite>CustomerRepository</cite> and has been used in both repository afterwards. The library will adapt the transaction process of <cite>ADO.NET</cite>. So whether the transaction object is created via an independent <cite>DbConnection</cite> object, as long as the connection is open, then the operation is valid.</p>
</div>
<div class="section" id="expression-tree">
<h1>Expression Tree<a class="headerlink" href="#expression-tree" title="Permalink to this headline">¶</a></h1>
<p>The expression tree is the brain of the library. It defines the best possible way of doing a <cite>WHERE</cite> expression (SQL Statement) by composing it via <cite>dynamic</cite> or <cite>System.Interfaces.IQueryGroup</cite> objects.</p>
<p>Objects used for composing the expression tree.</p>
<ul class="simple">
<li><strong>QueryGroup</strong>: used to group an expression.</li>
<li><strong>QueryField</strong>: holds the field/value pair values of the expressions.</li>
<li><strong>Conjunction</strong>: an enumeration that holds the value whether the expression is on <cite>And</cite> or <cite>Or</cite> operation.</li>
<li><strong>Operation</strong>: an enumeration that holds the value what kind of operation is going to be executed on certain expression. It holds the value of like <cite>Equal</cite>, <cite>NotEqual</cite>, <cite>Between</cite>, <cite>GreaterThan</cite> and etc.</li>
</ul>
<p>Certain repository operations are using the expression trees.</p>
<ul class="simple">
<li>Repository.BatchQuery</li>
<li>Repository.Count</li>
<li>Repository.CountBig</li>
<li>Repository.Delete</li>
<li>Repository.ExecuteNonQuery</li>
<li>Repository.ExecuteQuery</li>
<li>Repository.ExecuteScalar</li>
<li>Repository.InlineUpdate</li>
<li>Repository.Query</li>
<li>Repository.Update</li>
</ul>
<p>Certain connection extension methods are using the expression trees.</p>
<ul class="simple">
<li>DbConnection.ExecuteNonQuery</li>
<li>DbConnection.ExecuteQuery</li>
<li>DbConnection.ExecuteReader</li>
<li>DbConnection.ExecuteScalar</li>
</ul>
<p>There are two ways of building the expression trees, the explicit way by using <cite>IQueryGroup</cite> objects and dynamic way by using <cite>dynamic</cite> objects.</p>
<div class="section" id="explicit-query-expression">
<h2>Explicit Query Expression<a class="headerlink" href="#explicit-query-expression" title="Permalink to this headline">¶</a></h2>
<p>An explicit query expression are using the defined objects <cite>RepoDb.QueryGroup</cite>, <cite>RepoDb.QueryField</cite>, <cite>RepoDb.Enumerations.Conjunction</cite> and <cite>RepoDb.Enumerations.Operation</cite> when composing the expression.</p>
<p>Below is a pseudo code of explicit query expression.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="c1">// WHERE (Field1 = @Field1 AND Field2 = @Field2) AND ((Field3 = @Field3 OR Field4 = @Field4) AND (Field5 = @Field5 OR Field6 = @Field6));</span>
<span class="kt">var</span> <span class="n">tree</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="n">QueryField</span><span class="p">[]</span>
        <span class="p">{</span>
                <span class="c1">// List of QueryFields</span>
        <span class="p">},</span>
        <span class="k">new</span> <span class="n">QueryGroup</span><span class="p">[]</span>
        <span class="p">{</span>
                <span class="c1">// List of QueryGroups</span>
                <span class="k">new</span> <span class="nf">QueryGroup</span>
                <span class="p">(</span>
                        <span class="k">new</span> <span class="n">QueryField</span><span class="p">[]</span>
                        <span class="p">{</span>
                                <span class="c1">// List of QueryFields</span>
                        <span class="p">},</span>
                        <span class="k">new</span> <span class="n">QueryGroup</span><span class="p">[]</span>
                        <span class="p">{</span>
                                <span class="c1">// List of QueryGroups</span>
                                <span class="p">...</span>
                                <span class="p">...</span>
                                <span class="p">...</span>
                        <span class="p">}</span>
                        <span class="n">Conjunction</span><span class="p">.</span><span class="n">Or</span>
                <span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryGroup</span>
                <span class="p">(</span>
                        <span class="k">new</span> <span class="n">QueryField</span><span class="p">[]</span>
                        <span class="p">{</span>
                                <span class="c1">// List of QueryFields</span>
                        <span class="p">},</span>
                        <span class="k">new</span> <span class="n">QueryGroup</span><span class="p">[]</span>
                        <span class="p">{</span>
                                <span class="c1">// List of QueryGroups</span>
                                <span class="p">...</span>
                                <span class="p">...</span>
                                <span class="p">...</span>
                        <span class="p">}</span>
                        <span class="n">Conjunction</span><span class="p">.</span><span class="n">Or</span>
                <span class="p">)</span>
        <span class="p">},</span>
        <span class="n">Conjunction</span><span class="p">.</span><span class="n">And</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Actual explicit query tree expression.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="c1">// Last 3 months customer with CustomerId &gt;= 10045</span>
<span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="p">[]</span>
        <span class="p">{</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;CreatedDate&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">AddMonths</span><span class="p">(-</span><span class="m">3</span><span class="p">))</span>
        <span class="p">},</span>
        <span class="k">null</span><span class="p">,</span> <span class="c1">// Child QueryGroups</span>
        <span class="n">Conjunction</span><span class="p">.</span><span class="n">And</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="dynamic-query-expression">
<h2>Dynamic Query Expression<a class="headerlink" href="#dynamic-query-expression" title="Permalink to this headline">¶</a></h2>
<p>A dynamic query expression is using a single dynamic object when composing the expression.</p>
<p>Below is a pseudo code of dynamic query expression.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">tree</span> <span class="p">=</span> <span class="k">new</span>
<span class="p">{</span>
        <span class="n">Conjunction</span> <span class="p">=</span> <span class="n">Conjunction</span><span class="p">.</span><span class="n">And</span><span class="p">,</span>
        <span class="n">Field1</span> <span class="p">=</span> <span class="s">&quot;Field1&quot;</span><span class="p">,</span> <span class="c1">// QueryField</span>
        <span class="n">Field2</span> <span class="p">=</span> <span class="s">&quot;Field2&quot;</span><span class="p">,</span> <span class="c1">// QueryField</span>
        <span class="n">QueryGroups</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span>
        <span class="p">{</span>
                <span class="k">new</span>
                <span class="p">{</span>
                        <span class="n">Conjunction</span> <span class="p">=</span> <span class="n">Conjunction</span><span class="p">.</span><span class="n">Or</span><span class="p">,</span>
                        <span class="n">Field3</span> <span class="p">=</span> <span class="s">&quot;Field3&quot;</span><span class="p">,</span> <span class="c1">// QueryField</span>
                        <span class="n">Field4</span> <span class="p">=</span> <span class="s">&quot;Field4&quot;</span><span class="p">,</span>
                        <span class="n">QueryGroups</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span>
                        <span class="p">{</span>
                                <span class="p">...</span>
                        <span class="p">}</span>
                <span class="p">},</span>
                <span class="k">new</span>
                <span class="p">{</span>
                        <span class="n">Conjunction</span> <span class="p">=</span> <span class="n">Conjunction</span><span class="p">.</span><span class="n">Or</span><span class="p">,</span>
                        <span class="n">Field3</span> <span class="p">=</span> <span class="s">&quot;Field3&quot;</span><span class="p">,</span> <span class="c1">// QueryField</span>
                        <span class="n">Field4</span> <span class="p">=</span> <span class="s">&quot;Field4&quot;</span><span class="p">,</span>
                        <span class="n">QueryGroups</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span>
                        <span class="p">{</span>
                                <span class="p">...</span>
                        <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Actual dynamic query tree expression.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="c1">// Last 3 months customer with CustomerId &gt;= 10045</span>
<span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="k">new</span>
<span class="p">{</span>
        <span class="n">CustomerId</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span>
        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">AddMonths</span><span class="p">(-</span><span class="m">3</span><span class="p">)</span> <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="querygroup">
<h1>QueryGroup<a class="headerlink" href="#querygroup" title="Permalink to this headline">¶</a></h1>
<p>A query group object is used to group an expression when composing a tree expressions. It is equivalent to a grouping on a <cite>WHERE</cite> statement in SQL Statements.</p>
<p>Below are the constructor parameters.</p>
<ul class="simple">
<li><strong>queryFields</strong>: the list of <cite>IQueryField</cite> objects to be included in the expression composition. It stands as <cite>[FieldName] = &#64;FiedName</cite> when it comes to SQL Statement compositions.</li>
<li><strong>queryGroups</strong>: the list of child <cite>IQueryGroup</cite> objects to be included in the expresson composition. It stands as the <cite>([FieldName] = &#64;FieldName AND [FieldName1] = &#64;FieldName1)</cite> when it comes to SQL Statement compositions.</li>
<li><strong>conjunction</strong>: the conjuction to be used when grouping the fields. It stands as the <cite>AND</cite> or <cite>OR</cite> in the SQL Statement compositions.</li>
</ul>
<p>As mentioned above, below is a sample code to create a query group object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="c1">// Last 3 months customer with CustomerId &gt;= 10045</span>
<span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="p">[]</span>
        <span class="p">{</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;CreatedDate&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">.</span><span class="n">AddMonths</span><span class="p">(-</span><span class="m">3</span><span class="p">))</span>
        <span class="p">},</span>
        <span class="k">null</span><span class="p">,</span> <span class="c1">// Child QueryGroups</span>
        <span class="n">Conjunction</span><span class="p">.</span><span class="n">And</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="section" id="query-operations">
<h2>Query Operations<a class="headerlink" href="#query-operations" title="Permalink to this headline">¶</a></h2>
<p>The query operation defines the operation to be used by the query expression (field level) during the actual execution. It is located at <cite>RepoDb.Enumerations</cite> namespace.</p>
<p>List of Operations:</p>
<ul class="simple">
<li>Operation.Equal</li>
<li>Operation.NotEqual</li>
<li>Operation.LessThan</li>
<li>Operation.LessThanOrEqual</li>
<li>Operation.GreaterThan</li>
<li>Operation.GreaterThanOrEqual</li>
<li>Operation.Like</li>
<li>Operation.NotLike</li>
<li>Operation.Between</li>
<li>Operation.NotBetween</li>
<li>Operation.In</li>
<li>Operation.NotIn</li>
<li>Operation.All</li>
<li>Operation.Any</li>
</ul>
</div>
<div class="section" id="operation-equal">
<h2>Operation.Equal<a class="headerlink" href="#operation-equal" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine the <cite>equality</cite> of the field and data.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span>
<span class="p">{</span>
        <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Equal</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Equal</span><span class="p">,</span> <span class="m">10045</span> <span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-notequal">
<h2>Operation.NotEqual<a class="headerlink" href="#operation-notequal" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine the <cite>inequality</cite> of the field and data.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span>
<span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="s">&quot;Anna Fullerton&quot;</span> <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotEqual</span><span class="p">,</span> <span class="s">&quot;Anna Fullerton&quot;</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-lessthan">
<h2>Operation.LessThan<a class="headerlink" href="#operation-lessthan" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field value is <cite>less than</cite> of the defined value.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">LessThan</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">100</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">LessThan</span><span class="p">,</span> <span class="m">100</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-greaterthan">
<h2>Operation.GreaterThan<a class="headerlink" href="#operation-greaterthan" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field value is <cite>greater than</cite> of the defined value.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThan</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">0</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThan</span><span class="p">,</span> <span class="m">0</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-lessthanorequal">
<h2>Operation.LessThanOrEqual<a class="headerlink" href="#operation-lessthanorequal" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field value is <cite>less than or equal</cite> of the defined value.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">LessThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">100</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;.</span><span class="n">Query</span><span class="p">(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">LessThanOrEqual</span><span class="p">,</span> <span class="m">100</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-greaterthanorequal">
<h2>Operation.GreaterThanOrEqual<a class="headerlink" href="#operation-greaterthanorequal" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field value is <cite>greater than or equal</cite> of the defined value.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">0</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="m">0</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-like">
<h2>Operation.Like<a class="headerlink" href="#operation-like" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field is <cite>identitical</cite> to a given value.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Like</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="s">&quot;Anna%&quot;</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Like</span><span class="p">,</span> <span class="s">&quot;Anna%&quot;</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-notlike">
<h2>Operation.NotLike<a class="headerlink" href="#operation-notlike" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field is <cite>not identitical</cite> to a given value. An opposite of <cite>Operation.Like</cite>.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotLike</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="s">&quot;Anna%&quot;</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotLike</span><span class="p">,</span> <span class="s">&quot;Anna%&quot;</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-between">
<h2>Operation.Between<a class="headerlink" href="#operation-between" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field value is <cite>between</cite> 2 given values.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Between</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="n">Date1</span><span class="p">,</span> <span class="n">Date2</span> <span class="p">}</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Between</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10075</span> <span class="p">}</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;CreatedDate&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Between</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="n">Date1</span><span class="p">,</span> <span class="n">Date2</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Between</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10075</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-notbetween">
<h2>Operation.NotBetween<a class="headerlink" href="#operation-notbetween" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field value is <cite>not between</cite> 2 given values. An opposite of <cite>Operation.Between</cite>.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotBetween</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="n">Date1</span><span class="p">,</span> <span class="n">Date2</span> <span class="p">}</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotBetween</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10075</span> <span class="p">}</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;CreatedDate&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotBetween</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="n">Date1</span><span class="p">,</span> <span class="n">Date2</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotBetween</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10075</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-in">
<h2>Operation.In<a class="headerlink" href="#operation-in" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field value is <cite>in</cite> given values.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">In</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10046</span><span class="p">,</span> <span class="m">10047</span><span class="p">,</span> <span class="m">10048</span> <span class="p">}</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">In</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10046</span><span class="p">,</span> <span class="m">10047</span><span class="p">,</span> <span class="m">10048</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-notin">
<h2>Operation.NotIn<a class="headerlink" href="#operation-notin" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether the field value is <cite>not in</cite> given values. An opposite of <cite>Operation.In</cite>. See sample below.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotIn</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10046</span><span class="p">,</span> <span class="m">10047</span><span class="p">,</span> <span class="m">10048</span> <span class="p">}</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotIn</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10046</span><span class="p">,</span> <span class="m">10047</span><span class="p">,</span> <span class="m">10048</span> <span class="p">}</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-all">
<h2>Operation.All<a class="headerlink" href="#operation-all" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether <cite>all</cite> the field values satisfied the criteria.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span>
<span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">All</span><span class="p">,</span> <span class="c1">// Works as AND</span>
                <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span>
                <span class="p">{</span>
                        <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Like</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="s">&quot;Anna%&quot;</span> <span class="p">},</span>
                        <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="s">&quot;Tom Hawks&quot;</span> <span class="p">},</span>
                        <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotIn</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;Frank Myers&quot;</span><span class="p">,</span> <span class="s">&quot;Joe Austin&quot;</span> <span class="p">}</span> <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="n">QueryField</span><span class="p">[]</span>
        <span class="p">{</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Like</span><span class="p">,</span> <span class="s">&quot;Anna%&quot;</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotEqual</span><span class="p">,</span> <span class="s">&quot;Tom Hawks&quot;</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotIn</span><span class="p">,</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;Frank Myers&quot;</span><span class="p">,</span> <span class="s">&quot;Joe Austin&quot;</span> <span class="p">})</span>
        <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>The <cite>Operation.All</cite> only works at the <cite>dynamic</cite> expression tree to simply the composition of the statement. Passing a list of <cite>IQueryField</cite> in the <cite>IQueryGroup</cite> object will do the same when calling it explicitly.</p>
</div>
<div class="section" id="operation-any">
<h2>Operation.Any<a class="headerlink" href="#operation-any" title="Permalink to this headline">¶</a></h2>
<p>Part of the expression tree used to determine whether <cite>any</cite> of the field values satisfied the criteria.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span>
<span class="p">{</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Any</span><span class="p">,</span> <span class="c1">// Works as OR</span>
                <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span>
                <span class="p">{</span>
                        <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Like</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="s">&quot;Anna%&quot;</span> <span class="p">},</span>
                        <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="s">&quot;Tom Hawks&quot;</span> <span class="p">},</span>
                        <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">In</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;Frank Myers&quot;</span><span class="p">,</span> <span class="s">&quot;Joe Austin&quot;</span> <span class="p">}</span> <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="n">QueryField</span><span class="p">[]</span>
        <span class="p">{</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Like</span><span class="p">,</span> <span class="s">&quot;Anna%&quot;</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">NotEqual</span><span class="p">,</span> <span class="s">&quot;Tom Hawks&quot;</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">In</span><span class="p">,</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;Frank Myers&quot;</span><span class="p">,</span> <span class="s">&quot;Joe Austin&quot;</span> <span class="p">})</span>
        <span class="p">},</span>
        <span class="k">null</span><span class="p">,</span> <span class="c1">// List of QueryGroups</span>
        <span class="n">Conjunction</span><span class="p">.</span><span class="n">Or</span>
<span class="p">);</span>
</pre></div>
</div>
<p>The <cite>Operation.Any</cite> only works at the <cite>dynamic</cite> expression tree to simply the composition of the statement. Passing a list of <cite>IQueryField</cite> in the <cite>IQueryGroup</cite> object will do the same when calling it explicitly.</p>
</div>
</div>
<div class="section" id="repository-operations">
<h1>Repository Operations<a class="headerlink" href="#repository-operations" title="Permalink to this headline">¶</a></h1>
<p>The repositories contain different operations to manipulate the data from the database. Below are the list of common operations widely used.</p>
<ul class="simple">
<li><strong>Query</strong>: used to query a record from the database. It uses the <cite>SELECT</cite> command of SQL.</li>
<li><strong>Insert</strong>: used to insert a record in the database. It uses the <cite>INSERT</cite> command of SQL.</li>
<li><strong>Update</strong>: used to update a record in the database. It uses the <cite>UPDATE</cite> command of SQL.</li>
<li><strong>Delete</strong>: used to delete a record in the database. It uses the <cite>DELETE</cite> command of SQL.</li>
<li><strong>Merge</strong>: used to merge a record in the database. It uses the <cite>MERGE</cite> command of SQL.</li>
<li><strong>InlineUpdate</strong>: used to do column-based update of the records in the database. It uses the <cite>UPDATE</cite> command of SQL.</li>
<li><strong>Count</strong>: used to count all the records in the database. It uses the <cite>SELECT</cite>, <cite>COUNT</cite> command of SQL.</li>
<li><strong>CountBig</strong>: used to count (big) all the records in the database. It uses the <cite>SELECT</cite>, <cite>COUNT_BIG</cite> command of SQL.</li>
<li><strong>BatchQuery</strong>: used to query a record from the database by batch. It uses the <cite>SELECT</cite> in combination of <cite>ROW_NUMBER</cite> and <cite>ORDER</cite> command of SQL.</li>
<li><strong>BulkInsert</strong>: used to bulk-insert the records in the database.</li>
<li><strong>ExecuteQuery</strong>: used to read certain records from the database in fast-forward access. It returns an enumerable list of <cite>RepoDb.Interfaces.IDataEntity</cite> objects.</li>
<li><strong>ExecuteNonQuery</strong>: used to execute a non-queryable query statement in the database.</li>
<li><strong>ExecuteScalar</strong>: used to execute a command that returns a single-object value from the database.</li>
</ul>
<p>All operations mentioned above has its own corresponding asynchronous operation. Usually, the asynchronous operation is only appended by <cite>Async</cite> keyword. Below are the list of asynchronous operations.</p>
<ul class="simple">
<li><strong>QueryAsync</strong></li>
<li><strong>InsertAsync</strong></li>
<li><strong>UpdateAsync</strong></li>
<li><strong>DeleteAsync</strong></li>
<li><strong>MergeAsync</strong></li>
<li><strong>InlineUpdateAsync</strong></li>
<li><strong>CountAsync</strong></li>
<li><strong>CountBigAsync</strong></li>
<li><strong>BatchQueryAsync</strong></li>
<li><strong>BulkInsertAsync</strong></li>
<li><strong>ExecuteQueryAsync</strong></li>
<li><strong>ExecuteNonQueryAsync</strong></li>
<li><strong>ExecuteScalar</strong></li>
</ul>
<div class="section" id="query-operation">
<h2>Query Operation<a class="headerlink" href="#query-operation" title="Permalink to this headline">¶</a></h2>
<p>This operation is used to query a data from the database and returns an <cite>IEnumerable&lt;TEntity&gt;</cite> object. Below are the parameters.</p>
<ul class="simple">
<li><strong>where</strong>: an expression to used to filter the data.</li>
<li><strong>transaction</strong>: the transaction object to be used when querying a data.</li>
<li><strong>top</strong>: the value used to return certain number of rows from the database.</li>
<li><strong>orderBy</strong>: the list of fields to be used to sort the data during querying.</li>
<li><strong>cacheKey</strong>: the key of the cache to check.</li>
</ul>
<p>Below is a sample on how to query a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
</pre></div>
</div>
<p>Above snippet will return all the <cite>Customer</cite> records from the database. The data can filtered using the <cite>where</cite> parameter. See sample below.</p>
<p>Implicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">1</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
</pre></div>
</div>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span> <span class="p">}).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
</pre></div>
</div>
<p>Explicity way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="nf">QueryGroup</span><span class="p">(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="m">1</span><span class="p">).</span><span class="n">AsEnumerable</span><span class="p">())</span>
<span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
</pre></div>
</div>
<p>Below is the sample on how to query with multiple columns.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Anna Fullerton&quot;</span><span class="p">,</span> <span class="n">Conjunction</span><span class="p">.</span><span class="n">Or</span> <span class="p">});</span>
</pre></div>
</div>
<p>Explicity way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="nf">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="p">[]</span>
                <span class="p">{</span>
                        <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Equal</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
                        <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Equal</span><span class="p">,</span> <span class="s">&quot;Anna Fullerton&quot;</span><span class="p">)</span>
                <span class="p">},</span>
                <span class="k">null</span><span class="p">,</span>
                <span class="n">Conjunction</span><span class="p">.</span><span class="n">Or</span>
        <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>When querying a data where <cite>Id</cite> field is greater than 50 and less than 100. See sample expressions below.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Between</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[]</span> <span class="p">{</span> <span class="m">50</span><span class="p">,</span> <span class="m">100</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">QueryGroups</span> <span class="p">=</span> <span class="k">new</span><span class="p">[]</span>
                <span class="p">{</span>
                        <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">50</span> <span class="p">}</span> <span class="p">},</span>
                        <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">LessThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">100</span> <span class="p">}</span> <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span>
                <span class="p">{</span>
                        <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">All</span><span class="p">,</span>
                        <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span>
                        <span class="p">{</span>
                                <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">50</span> <span class="p">},</span>
                                <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">LessThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">100</span> <span class="p">}</span>
                        <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="nf">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="p">[]</span>
                <span class="p">{</span>
                        <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span>
                        <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">LessThanOrEqual</span><span class="p">,</span> <span class="m">100</span><span class="p">)</span>
                <span class="p">}</span>
        <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">(</span>
        <span class="k">new</span> <span class="nf">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Between</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">50</span><span class="p">,</span> <span class="m">100</span> <span class="p">}).</span><span class="n">AsEnumerable</span><span class="p">()</span>
        <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p><strong>Note</strong>: Querying a record using <cite>PrimaryKey</cite> will throw a <cite>PrimaryFieldNotFoundException</cite> exception back to the caller if the <cite>PrimaryKey</cite> is not found from the entity.</p>
<div class="section" id="ordering-a-query">
<h3>Ordering a Query<a class="headerlink" href="#ordering-a-query" title="Permalink to this headline">¶</a></h3>
<p>An ordering is the way of sorting the result of your query in <cite>ascending</cite> or <cite>descending</cite> order, depending on the qualifier fields. Below is a sample snippet that returns the <cite>Stock</cite> records ordered by <cite>ParentId</cite> field in ascending manner and <cite>Name</cite> field is in <cite>descending</cite> manner.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">orderBy</span> <span class="p">=</span> <span class="k">new</span>
<span class="p">{</span>
        <span class="n">CustomerId</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span><span class="p">,</span>
        <span class="n">Name</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Descending</span>
<span class="p">};</span>
<span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThan</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">1</span> <span class="p">}</span> <span class="p">},</span> <span class="n">orderBy</span><span class="p">:</span> <span class="n">OrderField</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">orderBy</span><span class="p">));</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">orderBy</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span>
<span class="p">{</span>
        <span class="k">new</span> <span class="nf">OrderField</span><span class="p">(</span><span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span><span class="p">),</span>
        <span class="k">new</span> <span class="nf">OrderField</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="n">Order</span><span class="p">.</span><span class="n">Descending</span><span class="p">)</span>
<span class="p">};</span>
<span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThan</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">1</span> <span class="p">}</span> <span class="p">},</span> <span class="n">orderBy</span><span class="p">:</span> <span class="n">orderBy</span><span class="p">);</span>
</pre></div>
</div>
<p>The <cite>RepodDb.OrderField</cite> is an object that is being used to order a query result. The <cite>Parse</cite> method is used to convert the <cite>dynamic</cite> object to become an <cite>OrderField</cite> instances.</p>
<p><strong>Note:</strong> When composing a dynamic ordering object, the value of the properties should be equal to <cite>RepoDb.Interfaces.Order</cite> values (<cite>Ascending</cite> or <cite>Descending</cite>). Otherwise, an exception will be thrown during <cite>OrderField.Parse</cite> operation.</p>
</div>
<div class="section" id="limiting-a-query-result">
<h3>Limiting a Query Result<a class="headerlink" href="#limiting-a-query-result" title="Permalink to this headline">¶</a></h3>
<p>A top parameter is used to limit the result when querying a data from the database. Below is a sample way on how to use the top parameter.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThan</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">1</span> <span class="p">}</span> <span class="p">},</span> <span class="n">top</span><span class="p">:</span> <span class="m">100</span><span class="p">);</span>
</pre></div>
</div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThan</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">1</span> <span class="p">}</span> <span class="p">},</span> <span class="n">top</span><span class="p">:</span> <span class="m">100</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="insert-operation">
<h2>Insert Operation<a class="headerlink" href="#insert-operation" title="Permalink to this headline">¶</a></h2>
<p>This operation is used to insert a record in the database. It returns an object valued by the <cite>PrimaryKey</cite> column. If the <cite>PrimaryKey</cite> column is identity, this operation will return the newly added identity column value.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the entity object to be inserted.</li>
<li><strong>transaction</strong>: the transaction object to be used when inserting a data.</li>
</ul>
<p>Below is a sample on how to insert a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span>
        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">};</span>
<span class="n">repository</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="update-operation">
<h2>Update Operation<a class="headerlink" href="#update-operation" title="Permalink to this headline">¶</a></h2>
<p>This operation is used to update an existing record from the database. It returns an <cite>int</cite> value indicating the number of rows affected by the updates.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the entity object to be updated.</li>
<li><strong>where</strong>: an expression to used when updating a record.</li>
<li><strong>transaction</strong>: the transaction object to be used when updating a data.</li>
</ul>
<p>Below is a sample on how to update a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">251</span> <span class="p">}).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="n">order</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
        <span class="n">order</span><span class="p">.</span><span class="n">UpdateDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Dynamic way (column-based update), or see InlineUpdate documentation:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">InlineUpdate</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">},</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">251</span> <span class="p">});</span>
</pre></div>
</div>
<p><strong>Note</strong>:  Updating a record using <cite>PrimaryKey</cite> will throw a <cite>PrimaryFieldNotFoundException</cite> exception back to the caller if the <cite>PrimaryKey</cite> is not found from the entity.</p>
</div>
<div class="section" id="delete-operation">
<h2>Delete Operation<a class="headerlink" href="#delete-operation" title="Permalink to this headline">¶</a></h2>
<p>This operation is used to delete an existing record from the database. It returns an <cite>int</cite> value indicating the number of rows affected by the delete.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>where</strong>: an expression to used when deleting a record.</li>
<li><strong>transaction</strong>: the transaction object to be used when deleting a data.</li>
</ul>
<p>Below is a sample on how to delete a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="s">&quot;251&quot;</span> <span class="p">}).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="n">order</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or by <cite>PrimaryKey</cite></p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
</pre></div>
</div>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="s">&quot;251&quot;</span> <span class="p">});</span>
</pre></div>
</div>
<p><strong>Note</strong>: Deleting a record using <cite>PrimaryKey</cite> will throw a <cite>PrimaryFieldNotFoundException</cite> exception back to the caller if the <cite>PrimaryKey</cite> is not found from the entity.</p>
</div>
<div class="section" id="merge-operation">
<h2>Merge Operation<a class="headerlink" href="#merge-operation" title="Permalink to this headline">¶</a></h2>
<p>This operation is used to merge an entity from the existing record from the database. It returns an <cite>int</cite> value indicating the number of rows affected by the merge.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the entity object to be merged.</li>
<li><strong>qualifiers</strong>: the list of fields to be used as a qualifiers when merging a record.</li>
<li><strong>transaction</strong>: the transaction object to be used when merging a data.</li>
</ul>
<p>Below is a sample on how to merge a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">1</span><span class="p">);</span>
<span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
<span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
<span class="n">repository</span><span class="p">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">order</span><span class="p">.</span><span class="n">Id</span> <span class="p">}));</span>
</pre></div>
</div>
<p><strong>Note</strong>: The merge is a process of updating and inserting. If the data is present in the database using the qualifiers, then the existing data will be updated, otherwise, a new data will be inserted in the database.</p>
</div>
<div class="section" id="inlineupdate-operation">
<h2>InlineUpdate Operation<a class="headerlink" href="#inlineupdate-operation" title="Permalink to this headline">¶</a></h2>
<p>This operation is used to do a column-based update of an existing record from the database. It returns an <cite>int</cite> value indicating the number of rows affected by the updates.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the dynamically or entity driven data entity object that contains the target fields to be updated.</li>
<li><strong>where</strong>: an expression to used when updating a record.</li>
<li><strong>transaction</strong>: the transaction object to be used when updating a data.</li>
</ul>
<p>Below is a sample on how to update a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">InlineUpdate</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">},</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="s">&quot;251&quot;</span> <span class="p">});</span>
</pre></div>
</div>
<p>The code snippets above will update the <cite>Quantity</cite> column of a order records from the dabatase where the value of <cite>Id</cite> column is equals to <cite>251</cite>.</p>
</div>
<div class="section" id="bulkinsert-operation">
<h2>BulkInsert Operation<a class="headerlink" href="#bulkinsert-operation" title="Permalink to this headline">¶</a></h2>
<p>This operation is used to bulk-insert the entities to the database. It returns an <cite>int</cite> value indicating the number of rows affected by the bulk-inserting.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entities</strong>: the list of entities to be inserted.</li>
<li><strong>transaction</strong>: the transaction object to be used when doing bulk-insert.</li>
</ul>
<p>Below is a sample on how to do bulk-insert.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">entities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
<span class="n">entities</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">Id</span> <span class="p">=</span> <span class="m">251</span><span class="p">,</span>
        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span><span class="p">,</span>
        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">});</span>
<span class="n">entities</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Stock</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">Id</span> <span class="p">=</span> <span class="m">251</span><span class="p">,</span>
        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">25</span><span class="p">,</span>
        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">15</span><span class="p">,</span>
        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">});</span>
<span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">(</span><span class="n">entities</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="count-and-countbig-operation">
<h2>Count and CountBig Operation<a class="headerlink" href="#count-and-countbig-operation" title="Permalink to this headline">¶</a></h2>
<p>These operations are used to count the number of records from the database. It returns a value indicating the number of counted rows based on the created expression.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>where</strong>: an expression to used when counting a record. If left <cite>null</cite>, all records from the database will be counted.</li>
<li><strong>transaction</strong>: the transaction object to be used when updating a data.</li>
</ul>
<p>Below is a sample on how to count a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">rows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
</pre></div>
</div>
<p>The code snippets above will count all the <cite>Order</cite> records from the database.</p>
<p>Below is the sample way to count a records with expression</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">rows</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
</pre></div>
</div>
<p>Above code snippets will count all the <cite>Order</cite> records from the database where <cite>CustomerId</cite> is equals to <cite>10045</cite>.</p>
<p><strong>Note</strong>: The same operation applies to <cite>CountBig</cite> operation. The only difference is that, <cite>CountBig</cite> is returning a <cite>System.Int64</cite> type and the internal SQL statetement is using the <cite>COUNT_BIG</cite> keyword.</p>
</div>
<div class="section" id="batchquery-operation">
<h2>BatchQuery Operation<a class="headerlink" href="#batchquery-operation" title="Permalink to this headline">¶</a></h2>
<p>This operation is used to batching when querying a data from the database. It returns an enumerable object of <cite>RepoDb.Interfaces.IDataEntity</cite> objects.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>where</strong>: an expression to used to filter the data.</li>
<li><strong>page</strong>: a zero-based index that signifies the page number of the batch to query.</li>
<li><strong>rowsPerBatch</strong>: the number of rows to be returned per batch.</li>
<li><strong>orderBy</strong>: the list of fields to be used to sort the data during querying.</li>
<li><strong>transaction</strong>: the transaction object to be used when querying a data.</li>
</ul>
<p>Below is a sample on how to query the first batch of data from the database where the number of rows per batch is 24.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="n">repository</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">0</span><span class="p">,</span> <span class="m">24</span><span class="p">);</span>
</pre></div>
</div>
<p>Below is the way to query by batch the data with expression.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="n">repository</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">24</span><span class="p">);</span>
</pre></div>
</div>
<p>Batching is very important when you are lazy-loading the data from the database. Below is a sample event listener for scroll (objects), doing the batch queries and post-process the data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">scroller</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">Any</span> <span class="n">Customimzed</span> <span class="n">Scroller</span> <span class="n">Object</span><span class="p">&gt;</span>
<span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">page</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">rowsPerBatch</span> <span class="p">=</span> <span class="m">24</span><span class="p">;</span>

<span class="n">scroller</span><span class="p">.</span><span class="n">ScrollToEnd</span> <span class="p">+=</span> <span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">page</span><span class="p">,</span> <span class="n">rowsPerBatch</span><span class="p">);</span>
        <span class="n">Process</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
        <span class="n">page</span><span class="p">++;</span>
<span class="p">};</span>

<span class="k">void</span> <span class="nf">Process</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;</span> <span class="n">orders</span><span class="p">)</span>
<span class="p">{</span>
        <span class="c1">// Process the orders (display on the page)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executequery-operation">
<h2>ExecuteQuery Operation<a class="headerlink" href="#executequery-operation" title="Permalink to this headline">¶</a></h2>
<p>This connection extension method is used to execute a SQL Statement query from the database in fast-forward access. It returns an <cite>IEnumerable</cite> object with <cite>dynamic</cite> or <cite>RepoDb.Interfaces.IDataEntity</cite> type as its generic type.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: the SQL statement to be used for execution.</li>
<li><strong>param</strong>: the parameters to be used for the execution. It could be an entity class or a dynamic object.</li>
<li><strong>commandTimeout</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>commandType</strong>: the type of command to be used whether it is a <cite>Text</cite>, <cite>StoredProcedure</cite> or <cite>TableDirect</cite>.</li>
<li><strong>transaction</strong>: the transaction object be used when executing the command.</li>
</ul>
<p>Below is the way on how to call the operation.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">param</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">};</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="s">&quot;SELECT * FROM [dbo].[Stock] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="executenonquery-operation">
<h2>ExecuteNonQuery Operation<a class="headerlink" href="#executenonquery-operation" title="Permalink to this headline">¶</a></h2>
<p>This connection extension method is used to execute a non-queryable SQL statement query. It returns an <cite>int</cite> that holds the number of affected rows during the execution.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: the SQL statement to be used for execution.</li>
<li><strong>param</strong>: the parameters to be used for the execution.</li>
<li><strong>commandTimeout</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>commandType</strong>: the type of command to be used whether it is a <cite>Text</cite>, <cite>StoredProcedure</cite> or <cite>TableDirect</cite>.</li>
<li><strong>transaction</strong>: the transaction object be used when executing the command.</li>
</ul>
<p>Below is the way on how to call the operation.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">param</span> <span class="p">=</span> <span class="k">new</span>
<span class="p">{</span>
        <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">};</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="s">&quot;UPDATE [dbo].[Stock] SET Quantity = @Quantity, UpdatedDate = @UpdatedDate WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="executescalar-operation">
<h2>ExecuteScalar Operation<a class="headerlink" href="#executescalar-operation" title="Permalink to this headline">¶</a></h2>
<p>This connection extension method is used to execute a query statement that returns a single value.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: the SQL statement to be used for execution.</li>
<li><strong>param</strong>: the parameters to be used for the execution.</li>
<li><strong>commandTimeout</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>commandType</strong>: the type of command to be used whether it is a <cite>Text</cite>, <cite>StoredProcedure</cite> or <cite>TableDirect</cite>.</li>
<li><strong>transaction</strong>: the transaction object be used when executing the command.</li>
</ul>
<p>Below is the way on how to call the operation.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">param</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">};</span>
<span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">(</span><span class="s">&quot;SELECT MAX([Id]) AS MaxIdByCustomerId FROM [dbo].[Stock] CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="n">param</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="working-with-cache">
<h1>Working with Cache<a class="headerlink" href="#working-with-cache" title="Permalink to this headline">¶</a></h1>
<p>The library supports caching when querying a data from the database. By the default, the <cite>RepoDb.MemoryCache</cite> is being used by the library. Given the name itself, the library works with memory caching by default. A cache is only working on <cite>Query</cite> operation of the repository. It can be access through the repository <cite>Cache</cite> property (implements <cite>RepoDb.Interfaces.ICache</cite> interface).</p>
<p>A cache key is important in order for the caching to cache the object. It should be unique to every cache item.</p>
<p>Below are the methods of <cite>ICache</cite> object.</p>
<ul class="simple">
<li><strong>Add</strong>: accepts an <cite>item</cite> or a <cite>key</cite> and <cite>value</cite> pair parameters. It adds an item to the <cite>Cache</cite> object. If an item is already existing, the item will be overriden.</li>
<li><strong>Clear</strong>: clear all items from the cache.</li>
<li><strong>Contains</strong>: accepts a <cite>key</cite> parameter. Checks whether the <cite>Cache</cite> object contains an item with the defined key.</li>
<li><strong>Get</strong>: accepts a <cite>key</cite> parameter. Returns a cached item object.</li>
<li><strong>GetEnumerator</strong>: returns an enumerator for <cite>IEnumerable&lt;ICacheItem&gt;</cite> objects. It contains all the cached items from the <cite>Cache</cite> object.</li>
<li><strong>Remove</strong>: accepts a <cite>key</cite> parameter. Removes an entry from the <cite>Cache</cite> object.</li>
</ul>
<p>One important object when manipulating a cache is the <cite>CacheItem</cite> object (implements <cite>RepoDb.Interfaces.ICacheItem</cite>). It acts as the cache item entry for the cache object.</p>
<p>Below are the constructor arguments of the <cite>ICacheItem</cite> object.</p>
<ul class="simple">
<li><strong>key</strong>: the key of the cache.</li>
<li><strong>value</strong>: the value object of the cache.</li>
</ul>
<p>Below are the properties of <cite>ICacheItem</cite> object.</p>
<ul class="simple">
<li><strong>Key</strong>: the key of the cache. It returns a <cite>System.String</cite> type.</li>
<li><strong>Value</strong>: the cached object of the item. It returns a <cite>System.Object</cite> type. It can be casted back to a defined object type.</li>
<li><strong>Timestamp</strong>: the time of the cache last refreshed. It returns a <cite>System.DateTime</cite> object.</li>
</ul>
<p>The repository caching operation is of the <cite>pseudo</cite> below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>VAR item = null
IF ($cacheKey is not null) THEN
        set $item = get value from cache where the key equals to $cacheKey
        IF ($item is not null) THEN
                RETURN item
        END IF
END IF
VAR $result = query the data from the database
IF ($result is not null AND $cacheKey is not null) THEN
        Add cache item where:
                Key = $cacheKey
                Value = $result
END IF
RETURN $result
</pre></div>
</div>
<p>Below is the way on how to query and cache the <cite>Stock</cite> data from the database with caching enabled.</p>
<div class="section" id="creating-a-cache-entry">
<h2>Creating a Cache Entry<a class="headerlink" href="#creating-a-cache-entry" title="Permalink to this headline">¶</a></h2>
<p>The snippets below declared a variable named <cite>cacheKey</cite>. The value of this variable acts as the key value of the items to be cached by the repository.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">cacheKey</span> <span class="p">=</span> <span class="s">&quot;CacheKey.Customers.StartsWith.Anna&quot;</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Like</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="s">&quot;Anna%&quot;</span> <span class="p">}</span> <span class="p">},</span> <span class="n">cacheKey</span><span class="p">:</span> <span class="n">cacheKey</span><span class="p">);</span>
</pre></div>
</div>
<p>First, it wil query the data from the database where the <cite>Name</cite> is started at <cite>Anna</cite>. Then, the operation will cache the result into the <cite>Cache</cite> object with the given key at the variable named <cite>cacheKey</cite> (valued <cite>CacheKey.Customers.StartsWith.Anna</cite>).</p>
<p>The next time the same query is executed, the repository automatically returns the cached item if the same key is passed.</p>
<p>Please note that the cache object of the repository is immutable per instance, this means that accessing the cache object directly passing the same cache key would return the same result.</p>
<p>Codes below will return the same result as above assuming the same repository object is used.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;)</span><span class="n">repository</span><span class="p">.</span><span class="n">Cache</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;CacheKey.Customers.StartsWith.Anna&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="checking-a-cache-entry">
<h2>Checking a Cache Entry<a class="headerlink" href="#checking-a-cache-entry" title="Permalink to this headline">¶</a></h2>
<p>Code below is the way on how to check if the cached item is present on the <cite>Cache</cite> object, assuming that a repository object has been created already.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">isExists</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">Cache</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="s">&quot;CacheKey&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="iterating-the-cache-entries">
<h2>Iterating the Cache Entries<a class="headerlink" href="#iterating-the-cache-entries" title="Permalink to this headline">¶</a></h2>
<p>Code below is the way on how to retrieve or iterate all the cached items from the <cite>Cache</cite> object, assuming that a repository object has been created already.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="c1">// Let&#39;s expect that the repository is meant for Customer data entity</span>
<span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">item</span> <span class="k">in</span> <span class="n">repository</span><span class="p">.</span><span class="n">Cache</span><span class="p">)</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">item</span> <span class="p">=</span> <span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;)</span><span class="n">item</span><span class="p">;</span>
        <span class="c1">// Process the item here</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="removing-or-clearing-a-cache">
<h2>Removing or Clearing a Cache<a class="headerlink" href="#removing-or-clearing-a-cache" title="Permalink to this headline">¶</a></h2>
<p>By default, the library does not support the auto-flush of the cache. Those forcing the developers to handle the flushing on its way.</p>
<p>Clearing or removing an entry from a cache is the only way to flush the cached objects.</p>
<p>See below on how to clear the cached item from the <cite>Cache</cite> object, assuming that a repository object has been created already.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">repository</span><span class="p">.</span><span class="n">Cache</span><span class="p">.</span><span class="n">Clear</span><span class="p">();</span>
</pre></div>
</div>
<p>Below is the way to remove specific cache item.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">repository</span><span class="p">.</span><span class="n">Cache</span><span class="p">.</span><span class="n">Remove</span><span class="p">(</span><span class="s">&quot;CacheKey&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="injecting-a-custom-cache-object">
<h2>Injecting a Custom Cache Object<a class="headerlink" href="#injecting-a-custom-cache-object" title="Permalink to this headline">¶</a></h2>
<p>The library supports a cache object injection in the repository level. As mentioned earlier, by default, the library is using the <cite>RepoDb.MemoryCache</cite> object. It can overriden by creating a class and implements the <cite>RepoDb.Interfaces.ICache</cite> interface, and passed it to the <cite>cache</cite> argument of the repository constructor.</p>
<p>Below is the way on how to create a custom <cite>Cache</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">FileCache</span> <span class="p">:</span> <span class="n">ICache</span>
<span class="p">{</span>
        <span class="k">public</span> <span class="nf">FileCache</span><span class="p">(</span><span class="kt">string</span> <span class="n">location</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// Add a logic on the constructor</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Add</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">object</span> <span class="k">value</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// Serialize to a File</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Add</span><span class="p">(</span><span class="n">ICacheItem</span> <span class="n">item</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// Serialize to a File</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Clear</span><span class="p">()</span>
        <span class="p">{</span>
                <span class="c1">// Delete the Files</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">Contains</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// Check if the Filename exists by Key</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="kt">object</span> <span class="nf">Get</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// Deserialize the File where the FileName is equals to Key, return the object</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">IEnumerator</span><span class="p">&lt;</span><span class="n">ICacheItem</span><span class="p">&gt;</span> <span class="n">GetEnumerator</span><span class="p">()</span>
        <span class="p">{</span>
                <span class="c1">// Get the File.ParentFolder.Files enumerator and deserialize each file</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Remove</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// Delete the File where the FileName is equals to Key</span>
        <span class="p">}</span>

        <span class="n">IEnumerator</span> <span class="n">IEnumerable</span><span class="p">.</span><span class="n">GetEnumerator</span><span class="p">()</span>
        <span class="p">{</span>
                <span class="c1">// Get the File.ParentFolder.Files enumerator and deserialize each file</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below is the way on how to inject the custom cache to a repository.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">fileCache</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileCache</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span>
        <span class="m">0</span><span class="p">,</span> <span class="c1">// commandTimeout</span>
        <span class="n">fileCache</span><span class="p">,</span> <span class="c1">// cache</span>
        <span class="k">null</span><span class="p">,</span> <span class="c1">// trace</span>
        <span class="k">null</span><span class="p">,</span> <span class="c1">// statementBuilder</span>
<span class="p">);</span>
</pre></div>
</div>
<p>The snippets above creates a class named <cite>FileCache</cite> that implements the <cite>ICache</cite> interfaces. By implementing the said interface, the class is now qualified to become a library <cite>Cache</cite> object.</p>
<p>Upon creating a repository, the <cite>fileCache</cite> variable is being passed in the <cite>cache</cite> parameter. This signals the repository to use the <cite>FileCache</cite> class as the cache manager object of the <cite>Query</cite> operation.</p>
<p><strong>Note:</strong> The caller can activate a debugger on the <cite>FileCache</cite> class to enable debugging. When the callers call the <cite>Query</cite> method and passed a <cite>cacheKey</cite> value on it, the breakpoint will be hit by the debugger if it is placed inside <cite>Add</cite> method of the <cite>FileCache</cite> class.</p>
</div>
</div>
<div class="section" id="working-with-trace">
<h1>Working with Trace<a class="headerlink" href="#working-with-trace" title="Permalink to this headline">¶</a></h1>
<p>One of the unique built-in feature of the library is tracing. It allows developers to do debugging or tracing on the operations while executing it against the database.</p>
<p>With tracing, the developers can able to create its own <cite>Trace</cite> object and inject in the repository.</p>
<div class="section" id="itrace-interface">
<h2>ITrace Interface<a class="headerlink" href="#itrace-interface" title="Permalink to this headline">¶</a></h2>
<p>This interface is the heart of library’s tracing feature. It resides from <cite>RepoDb.Interfaces</cite> namespace. This interface is required to be implemented at the custom trace classes to enable the tracing, then, the custom class must be injected in the repository.</p>
<p>The <cite>ITrace</cite> interface has the follow trace methods.</p>
<ul class="simple">
<li><strong>AfterBatchQuery</strong>: called after the <cite>Repository.BatchQuery</cite> operation has been executed.</li>
<li><strong>AfterBulkInsert</strong>: called after the <cite>Repository.BulkInsert</cite> operation has been executed.</li>
<li><strong>AfterCount</strong>: called after the <cite>Repository.Count</cite> operation has been executed.</li>
<li><strong>AfterCountBig</strong>: called after the <cite>Repository.CountBig</cite> operation has been executed.</li>
<li><strong>AfterDelete</strong>: called after the <cite>Repository.Delete</cite> operation has been executed.</li>
<li><strong>AfterExecuteNonQuery</strong>: called after the <cite>Repository.ExecuteNonQuery</cite> operation has been executed.</li>
<li><strong>AfterExecuteQuery</strong>: called after the <cite>Repository.ExecuteQuery</cite> operation has been executed.</li>
<li><strong>AfterExecuteReader</strong>: called after the <cite>Repository.ExecuteReader</cite> operation has been executed.</li>
<li><strong>AfterExecuteScalar</strong>: called after the <cite>Repository.ExecuteScalar</cite> operation has been executed.</li>
<li><strong>AfterInlineUpdate</strong>: called after the <cite>Repository.InlineUpdate</cite> operation has been executed.</li>
<li><strong>AfterInsert</strong>: called after the <cite>Repository.Insert</cite> operation has been executed.</li>
<li><strong>AfterMerge</strong>: called after the <cite>Repository.Merge</cite> operation has been executed.</li>
<li><strong>AfterQuery</strong>: called after the <cite>Repository.Query</cite> operation has been executed.</li>
<li><strong>AfterUpdate</strong>: called after the <cite>Repository.Update</cite> operation has been executed.</li>
</ul>
<p>Note: All trace methods mentioned above accepts the parameter named <cite>log</cite> of type <cite>RepoDb.Interfaces.ITraceLog</cite>.</p>
<ul class="simple">
<li><strong>BeforeBatchQuery</strong>: called before the <cite>Repository.BatchQuery</cite> actual execution.</li>
<li><strong>BeforeBulkInsert</strong>: called before the <cite>Repository.BulkInsert</cite> actual execution.</li>
<li><strong>BeforeCount</strong>: called before the <cite>Repository.Count</cite> actual execution.</li>
<li><strong>BeforeCountBig</strong>: called before the <cite>Repository.CountBig</cite> actual execution.</li>
<li><strong>BeforeDelete</strong>: called before the <cite>Repository.Delete</cite> actual execution.</li>
<li><strong>BeforeExecuteNonQuery</strong>: called before the <cite>Repository.ExecuteNonQuery</cite> actual execution.</li>
<li><strong>BeforeExecuteQuery</strong>: called before the <cite>Repository.ExecuteQuery</cite> actual execution.</li>
<li><strong>BeforeExecuteReader</strong>: called before the <cite>Repository.ExecuteReader</cite> actual execution.</li>
<li><strong>BeforeExecuteScalar</strong>: called before the <cite>Repository.ExecuteScalar</cite> actual execution.</li>
<li><strong>BeforeInlineUpdate</strong>: called before the <cite>Repository.InlineUpdate</cite> actual execution.</li>
<li><strong>BeforeInsert</strong>: called before the <cite>Repository.Insert</cite> actual execution.</li>
<li><strong>BeforeMerge</strong>: called before the <cite>Repository.Merge</cite> actual execution.</li>
<li><strong>BeforeQuery</strong>: called before the <cite>Repository.Query</cite> actual execution.</li>
<li><strong>BeforeUpdate</strong>: called before the <cite>Repository.Update</cite> actual execution.</li>
</ul>
<p>Note: All trace methods mentioned above accepts the parameter named <cite>log</cite> of type <cite>RepoDb.Interfaces.ICancellableTraceLog</cite>.</p>
</div>
<div class="section" id="itracelog-interface">
<h2>ITraceLog Interface<a class="headerlink" href="#itracelog-interface" title="Permalink to this headline">¶</a></h2>
<p>This interface and deriving objects are used by the <cite>RepoDb.Interfaces.ITrace</cite> object as a method argument during the <cite>After</cite> operations.</p>
<p>Below are the properties of <cite>ITraceLog</cite> object.</p>
<ul class="simple">
<li><strong>Method</strong>: a <cite>System.Reflection.MethodBase</cite> object that holds the pointer to the actual method that triggers the execution of the operation.</li>
<li><strong>Result</strong>: an object that holds the result of the execution.</li>
<li><strong>Parameter</strong>: an object that defines the parameters used when executing the operation.</li>
<li><strong>Statement</strong>: the actual query statement used in the execution.</li>
<li><strong>ExecutionTime</strong>: a <cite>System.Timespan</cite> object that holds the time length of actual execution.</li>
</ul>
</div>
<div class="section" id="icancellabletracelog-interface">
<h2>ICancellableTraceLog Interface<a class="headerlink" href="#icancellabletracelog-interface" title="Permalink to this headline">¶</a></h2>
<p>This interface and deriving objects are used by the <cite>RepoDb.Interfaces.ITrace</cite> object as a method argument at the <cite>Before</cite> operations. It inherits the <cite>RepoDb.Interfaces.ITrace</cite> interface.</p>
<p>Below are the properties of <cite>ICancellableTraceLog</cite> object.</p>
<ul class="simple">
<li><strong>IsCancelled</strong>: a property used to identify whether the operation is canceled.</li>
<li><strong>IsThrowException</strong>: a property used to identify whether an exception is thrown after cancelation. Exception being thrown is of type <cite>RepoDb.Exceptions.CancelledExecutionException</cite>.</li>
</ul>
</div>
<div class="section" id="creating-a-custom-trace-object">
<h2>Creating a Custom Trace Object<a class="headerlink" href="#creating-a-custom-trace-object" title="Permalink to this headline">¶</a></h2>
<p>Below is a sample customized <cite>Trace</cite> object.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">NorthwindDatabaseTrace</span> <span class="p">:</span> <span class="n">ITrace</span>
<span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">BeforeBatchQuery</span><span class="p">(</span><span class="n">ICancellableTraceLog</span> <span class="n">log</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">AfterBatchQuery</span><span class="p">(</span><span class="n">ITraceLog</span> <span class="n">log</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">BeforeBulkInsert</span><span class="p">(</span><span class="n">ICancellableTraceLog</span> <span class="n">log</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">AfterBulkInsert</span><span class="p">(</span><span class="n">ITraceLog</span> <span class="n">log</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below is the way on how to inject a Trace class in the repository.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">trace</span> <span class="p">=</span> <span class="k">new</span> <span class="n">NorthwindDatabaseTrace</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">repository</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbRepository</span><span class="p">&lt;</span><span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span>
        <span class="m">0</span><span class="p">,</span> <span class="c1">// commandTimeout</span>
        <span class="k">null</span><span class="p">,</span> <span class="c1">// cache</span>
        <span class="n">trace</span><span class="p">,</span> <span class="c1">// trace</span>
        <span class="k">null</span><span class="p">,</span> <span class="c1">// statementBuilder</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Once the customized Trace object has been injected, a breakpoint can be placed in any of the methods of the custom Trace class, it is debug-gable once the debugger hits the breakpoint.</p>
</div>
<div class="section" id="canceling-an-operation">
<h2>Canceling an Operation<a class="headerlink" href="#canceling-an-operation" title="Permalink to this headline">¶</a></h2>
<p>To cancel an operation, simply call the method named <cite>Cancel</cite> of type <cite>RepoDb.Interfaces.ICancelableTraceLog</cite> in any <cite>Before</cite> operation.</p>
<p>Below is a sample code that calls the <cite>Cancel</cite> method of the <cite>BeforeQuery</cite> operation if any of the specified keywords from the variable named <cite>keywords</cite> is found from the statement.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">void</span> <span class="nf">BeforeQuery</span><span class="p">(</span><span class="n">ICancellableTraceLog</span> <span class="n">log</span><span class="p">)</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">keywords</span> <span class="p">=</span> <span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;INSERT&quot;</span><span class="p">,</span> <span class="s">&quot;DELETE&quot;</span><span class="p">,</span> <span class="s">&quot;UPDATE&quot;</span><span class="p">,</span> <span class="s">&quot;DROP&quot;</span><span class="p">,</span> <span class="s">&quot;MERGE&quot;</span><span class="p">,</span> <span class="s">&quot;ALTER&quot;</span> <span class="p">};</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">keywords</span><span class="p">.</span><span class="n">Any</span><span class="p">(</span><span class="n">keyword</span> <span class="p">=&gt;</span> <span class="n">log</span><span class="p">.</span><span class="n">Statement</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">keyword</span><span class="p">)))</span>
        <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;A suspicious statement has been injected on the Query operations.&quot;</span><span class="p">);</span>
                <span class="n">log</span><span class="p">.</span><span class="n">Cancel</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By passing the value of <cite>true</cite> in the parameter when calling the <cite>Cancel</cite> method, it would signal the library to throw an <cite>RepoDb.Exception.CancelledExecutionException</cite> exception object back to the caller.</p>
</div>
</div>
<div class="section" id="working-with-statementbuilder">
<h1>Working with StatementBuilder<a class="headerlink" href="#working-with-statementbuilder" title="Permalink to this headline">¶</a></h1>
<p>The library supports statement building injection, allowing the developers to override the default query statement the library is using. By default, the library is using the <cite>RepoDb.SqlDbStatementBuilder</cite> class that implements the <cite>RepoDb.Interfaces.IStatementBuilder</cite> interface.</p>
<p>In order to override the statement builder, the developer must create a class that implements the <cite>RepoDb.Interfaces.IStatementBuilder</cite> interface. This allows the class to be injectable in the repository and implements the necessary methods needed by all operations.</p>
<p>A <cite>QueryBuilder</cite> object comes along the way when the custom statement builder is being created. This object is a helper object when composing the actual SQL Statements. See the <cite>QueryBuilder</cite> documentation.</p>
<p>Below are the methods of the <cite>IStatementBuilder</cite> interface.</p>
<ul class="simple">
<li><strong>CreateBatchQuery</strong>: called when creating a <cite>BatchQuery</cite> statement.</li>
<li><strong>CreateCount</strong>: called when creating a <cite>Count</cite> statement.</li>
<li><strong>CreateCountBig</strong>: called when creating a <cite>CountBig</cite> statement.</li>
<li><strong>CreateDelete</strong>: called when creating a <cite>Delete</cite> statement.</li>
<li><strong>CreateInlineUpdate</strong>: called when creating a <cite>InlineUpdate</cite> statement.</li>
<li><strong>CreateInsert</strong>: called when creating a <cite>Insert</cite> statement.</li>
<li><strong>CreateMerge</strong>: called when creating a <cite>Merge</cite> statement.</li>
<li><strong>CreateQuery</strong>: called when creating a <cite>Query</cite> statement.</li>
<li><strong>CreateUpdate</strong>: called when creating a <cite>Update</cite> statement.</li>
</ul>
<div class="section" id="querybuilder-object">
<h2>QueryBuilder Object<a class="headerlink" href="#querybuilder-object" title="Permalink to this headline">¶</a></h2>
<p>A query builder is an helper object used when creating a query statement in the statement builders. It contains important methods that is very useful to fluently construct the statement.</p>
<p>By default, the library is using the <cite>RepoDb.QueryBuilder&lt;TEntity&gt;</cite> object(implements the <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite> when composing the statement.</p>
<p>Below is a sample code that creates a SQL Statement for the <cite>Query</cite> operation for <cite>Oracle</cite> data provide.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateQuery&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where, int? top = 0, IEnumerable&lt;IOrderField&gt; orderBy = null) where TEntity : IDataEntity
{
        // Create an initial SELECT statement
        queryBuilder.Clear()
                .Select()
                .Fields(Command.Query)
                .From()
                .Table(Command.Query);

        // Add all fields for WHERE
        if (where != null)
        {
                queryBuilder.Where(where);
        }

        // Add the LIMIT (TOP in SQL Server)
        if (top &gt; 0)
        {
                // In Oracle, SELECT [Fields] FROM [Table] WHERE [Fields] AND ROWNUM &lt;=(Rows)
                queryBuilder.WriteText($&quot;AND (ROWNUM &lt;= {top})&quot;);
        }

        // End the builder
        queryBuilder.End();

        // Return the Statement
        return queryBuilder.ToString();
}
</pre></div>
</div>
<p>The methods of this object might be limited as it varies on the target data provider to be implemented. This object is open for modification soon for extensibility support. We are happy to open this to become inherittable in the near future if this is necessary for the .NET community.</p>
<p><strong>Note</strong>: The query builder is not inheritable and we suggest not to create a customized query builder.</p>
</div>
<div class="section" id="createbatchquery-method">
<h2>CreateBatchQuery Method<a class="headerlink" href="#createbatchquery-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>BatchQuery</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateBatchQuery</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when creating a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
<li><strong>where</strong>: the expression used when creating a statement (of type <cite>RepoDb.Interfaces.IQueryGroup</cite>).</li>
<li><strong>page</strong>: the page number implied when creating a statement.</li>
<li><strong>rowsPerBatch</strong>: the size of the rows implied when creating a statement.</li>
<li><strong>orderBy</strong>: the fields used in the <cite>ORDER BY</cite> when creating a statement.</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateBatchQuery</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateBatchQuery&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where, int page, int rowsPerBatch, IEnumerable&lt;IOrderField&gt; orderBy) where TEntity : IDataEntity
{
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        queryBuilder
                .Clear()
                .With()
                .WriteText(&quot;CTE&quot;)
                .As()
                .OpenParen()
                .Select()
                .RowNumber()
                .Over()
                .OpenParen()
                .OrderBy(orderBy)
                .CloseParen()
                .As(&quot;[RowNumber],&quot;)
                .Fields(Command.BatchQuery)
                .From()
                .Table(Command.BatchQuery)
                .Where(where)
                .CloseParen()
                .Select()
                .Fields(Command.BatchQuery)
                .From()
                .WriteText(&quot;CTE&quot;)
                .WriteText($&quot;WHERE ([RowNumber] BETWEEN {(page * rowsPerBatch) + 1} AND {(page + 1) * rowsPerBatch})&quot;)
                .OrderBy(orderBy)
                .End();
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="createcount-method">
<h2>CreateCount Method<a class="headerlink" href="#createcount-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>Count</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateCount</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when creating a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
<li><strong>where</strong>: the expression used when creating a statement (of type <cite>RepoDb.Interfaces.IQueryGroup</cite>).</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateCount</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateCount&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where) where TEntity : IDataEntity
{
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        queryBuilder
                .Clear()
                .Select()
                .Count()
                .WriteText(&quot;(*) AS [Counted]&quot;)
                .From()
                .Table(Command.Count)
                .Where(where)
                .End();
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="createcountbig-method">
<h2>CreateCountBig Method<a class="headerlink" href="#createcountbig-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>CountBig</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateCountBig</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when creating a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
<li><strong>where</strong>: the expression used when creating a statement (of type <cite>RepoDb.Interfaces.IQueryGroup</cite>).</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateCountBig</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateCountBig&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where) where TEntity : IDataEntity
{
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        queryBuilder
                .Clear()
                .Select()
                .CountBig()
                .WriteText(&quot;(*) AS [Counted]&quot;)
                .From()
                .Table(Command.CountBig)
                .Where(where)
                .End();
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="createdelete-method">
<h2>CreateDelete Method<a class="headerlink" href="#createdelete-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>Delete</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateDelete</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when creating a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
<li><strong>where</strong>: the expression used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryGroup</cite>).</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateDelete</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateDelete&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where) where TEntity : IDataEntity
{
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        queryBuilder
                .Clear()
                .Delete()
                .From()
                .Table(Command.Delete)
                .Where(where)
                .End();
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="createinlineupdate-method">
<h2>CreateInlineUpdate Method<a class="headerlink" href="#createinlineupdate-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>InlineUpdate</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateInlineUpdate</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
<li><strong>fields</strong>: the list of fields to be updated when composing a statement (on enumerable of type <cite>RepoDb.Interfaces.Field</cite>).</li>
<li><strong>where</strong>: the expression used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryGroup</cite>).</li>
<li><strong>overrideIgnore</strong>: the flag used to identify whether all the ignored fields will be included in the operation when composing a statement.</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateInlineUpdate</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateInlineUpdate&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IEnumerable&lt;IField&gt; fields, IQueryGroup where, bool? overrideIgnore = false) where TEntity : IDataEntity
{
        if (overrideIgnore == false)
        {
                var properties = PropertyCache.Get&lt;TEntity&gt;(Command.InlineUpdate)
                        .Select(property =&gt; property.GetMappedName());
                var unmatches = fields?.Where(field =&gt;
                        properties?.FirstOrDefault(property =&gt;
                                field.Name.ToLower() == property.ToLower()) == null);
                if (unmatches?.Count() &gt; 0)
                {
                        throw new InvalidOperationException($&quot;The following columns ({unmatches.Select(field =&gt; field.AsField()).Join(&quot;, &quot;)}) &quot; +
                                $&quot;are not updatable for entity ({DataEntityExtension.GetMappedName&lt;TEntity&gt;(Command.InlineUpdate)}).&quot;);
                }
        }
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        queryBuilder
                .Clear()
                .Update()
                .Table(Command.InlineUpdate)
                .Set()
                .FieldsAndParameters(fields)
                .Where(where)
                .End();
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="createinsert-method">
<h2>CreateInsert Method<a class="headerlink" href="#createinsert-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>Insert</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateInsert</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateInsert</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateInsert&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder) where TEntity : IDataEntity
{
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        var primary = PrimaryPropertyCache.Get&lt;TEntity&gt;();
        queryBuilder
                .Clear()
                .Insert()
                .Into()
                .Table(Command.Insert)
                .OpenParen()
                .Fields(Command.Insert)
                .CloseParen()
                .Values()
                .OpenParen()
                .Parameters(Command.Insert)
                .CloseParen()
                .End();
        if (primary != null)
        {
                var result = primary.IsIdentity() ? &quot;SCOPE_IDENTITY()&quot; : $&quot;@{primary.GetMappedName()}&quot;;
                queryBuilder
                        .Select()
                        .WriteText(result)
                        .As(&quot;[Result]&quot;)
                        .End();
        }
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="createmerge-method">
<h2>CreateMerge Method<a class="headerlink" href="#createmerge-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>Merge</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateMerge</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
<li><strong>qualifiers</strong>: the list of fields to be used as a qualifiers when composing a statement (on enumerable of type <cite>RepoDb.Interfaces.Field</cite>).</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateMerge</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateMerge&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IEnumerable&lt;IField&gt; qualifiers) where TEntity : IDataEntity
{
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        if (qualifiers == null)
        {
                var primaryKey = PrimaryPropertyCache.Get&lt;TEntity&gt;();
                if (primaryKey != null)
                {
                        qualifiers = new Field(primaryKey.Name).AsEnumerable();
                }
        }
        queryBuilder
                .Clear()
                // MERGE T USING S
                .Merge()
                .Table(Command.Merge)
                .As(&quot;T&quot;)
                .Using()
                .OpenParen()
                .Select()
                .ParametersAsFields(Command.None) // All fields must be included for selection
                .CloseParen()
                .As(&quot;S&quot;)
                // QUALIFIERS
                .On()
                .OpenParen()
                .WriteText(qualifiers?
                        .Select(
                                field =&gt; field.AsJoinQualifier(&quot;S&quot;, &quot;T&quot;))
                                        .Join($&quot; {Constant.And.ToUpper()} &quot;))
                .CloseParen()
                // WHEN NOT MATCHED THEN INSERT VALUES
                .When()
                .Not()
                .Matched()
                .Then()
                .Insert()
                .OpenParen()
                .Fields(Command.Merge)
                .CloseParen()
                .Values()
                .OpenParen()
                .Parameters(Command.Merge)
                .CloseParen()
                // WHEN MATCHED THEN UPDATE SET
                .When()
                .Matched()
                .Then()
                .Update()
                .Set()
                .FieldsAndAliasFields(Command.Merge, &quot;S&quot;)
                .End();
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="createquery-method">
<h2>CreateQuery Method<a class="headerlink" href="#createquery-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>Query</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateQuery</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
<li><strong>where</strong>: the expression used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryGroup</cite>).</li>
<li><strong>top</strong>: the value that identifies the number of rows to be returned when composing a statement.</li>
<li><strong>orderBy</strong>: the fields used in the <cite>ORDER BY</cite> when creating a statement.</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateQuery</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateQuery&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where, int? top = 0, IEnumerable&lt;IOrderField&gt; orderBy = null) where TEntity : IDataEntity
{
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        queryBuilder
                .Clear()
                .Select()
                .Top(top)
                .Fields(Command.Query)
                .From()
                .Table(Command.Query)
                .Where(where)
                .OrderBy(orderBy)
                .End();
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="createupdate-method">
<h2>CreateUpdate Method<a class="headerlink" href="#createupdate-method" title="Permalink to this headline">¶</a></h2>
<p>This method is being called when the <cite>Update</cite> operation of the repository is being called.</p>
<p>Below are the arguments of <cite>CreateUpdate</cite> method.</p>
<ul class="simple">
<li><strong>queryBuilder</strong>: the builder used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryBuilder&lt;TEntity&gt;</cite>).</li>
<li><strong>where</strong>: the expression used when composing a statement (of type <cite>RepoDb.Interfaces.IQueryGroup</cite>).</li>
</ul>
<p>See below the actual implementation of <cite>SqlDbStatementBuilder</cite> object for <cite>CreateUpdate</cite> method.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public string CreateUpdate&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where) where TEntity : IDataEntity
{
        queryBuilder = queryBuilder ?? new QueryBuilder&lt;TEntity&gt;();
        queryBuilder
                .Clear()
                .Update()
                .Table(Command.Update)
                .Set()
                .FieldsAndParameters(Command.Update)
                .Where(where)
                .End();
        return queryBuilder.GetString();
}
</pre></div>
</div>
</div>
<div class="section" id="creating-a-custom-statement-builder">
<h2>Creating a custom Statement Builder<a class="headerlink" href="#creating-a-custom-statement-builder" title="Permalink to this headline">¶</a></h2>
<p>The main reason why the library supports the statement builder is to allow the developers override the default statement builder of the library. By default, the library statement builder is only limited for SQL Server providers (as SQL Statements). However, it will fail if the library is being used to access the Oracle, MySql or any other providers.</p>
<p>To create a custom statement builder, simply create a class and implements the <cite>RepoDb.Interfaces.IStatementBuilder</cite> interface.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>public class OracleDbStatementBuilder : IStatementBuilder
{
        public string CreateQuery&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where, int? top = 0,
                IEnumerable&lt;IOrderField&gt; orderBy = null) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }

        public string CreateBatchQuery&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where, int page,
                int rowsPerBatch, IEnumerable&lt;IOrderField&gt; orderby) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }

        public string CreateCount&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }

        public string CreateCountBig&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }

        public string CreateDelete&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }

        public string CreateInlineUpdate&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IEnumerable&lt;IField&gt; fields, IQueryGroup where, bool? overrideIgnore = false) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }

        public string CreateInsert&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }

        public string CreateMerge&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IEnumerable&lt;IField&gt; qualifiers) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }

        public string CreateUpdate&lt;TEntity&gt;(IQueryBuilder&lt;TEntity&gt; queryBuilder, IQueryGroup where) where TEntity : IDataEntity
        {
                throw new NotImplementedException();
        }
}
</pre></div>
</div>
<p>Once the custom statement builder is created, it then can be used as an injectable object into the repository. See sample below injecting a statement builder for Oracle provider.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>var statementBuilder = new OracleDbStatementBuilder();
var repository = new DbRepository&lt;SqlConnection&gt;(@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;
        0, // commandTimeout
        null, // cache
        null, // trace
        statementBuilder, // statementBuilder
);
</pre></div>
</div>
<p>With the code snippets above, everytime the repository operation methods is being called, the <cite>OracleStatementBuilder</cite> corresponding method will be executed.</p>
</div>
<div class="section" id="mapping-a-statement-builder">
<h2>Mapping a Statement Builder<a class="headerlink" href="#mapping-a-statement-builder" title="Permalink to this headline">¶</a></h2>
<p>By default, the library is using the <cite>RepoDb.SqlDbStatementBuilder</cite> object for the statement builder. As discussed above, when creating a custom statement builder, it can then be injected as an object in the repository. However, if the developer wants to map the statement builder by provider level, this feature comes into the play.</p>
<p>The mapper is of static type <cite>RepoDb.StatementBuilderMapper</cite>.</p>
<p>The following are the methods of this object.</p>
<ul class="simple">
<li><strong>Get</strong>: returns the instance of statement builder by type (of type <cite>System.Data.IDbConnection</cite>).</li>
<li><strong>Map</strong>: maps the custom statement builder to a type (of type <cite>System.Data.IDbConnection</cite>).</li>
</ul>
<p>Mapping a statement builder enables the developer to map the custom statement builder by provider level.</p>
<p>Let say for example, if the developers created the following repositories:</p>
<blockquote>
<div><ul class="simple">
<li>CustomerRepository (for <cite>SqlConnection</cite>)</li>
<li>ProductRepository (for <cite>SqlConnection</cite>)</li>
<li>OrderRepository (for <cite>OracleConnection</cite>)</li>
<li>CompanyRepository (for <cite>OleDbConnection</cite>)</li>
</ul>
</div></blockquote>
<p>Then, by mapping a custom statement builders, it will enable the library to summon the statement builder based on the provider of the repository. With the following repositories defined above, the developers must implement atleast two (2) custom statement builder (one for Oracle provider and one for OleDb provider).</p>
<p>Let say the developer created 2 new custom statement builders named:</p>
<blockquote>
<div><ul class="simple">
<li>OracleStatementBuilder</li>
<li>OleDbStatementBuilder</li>
</ul>
</div></blockquote>
<p>The developers can now map the following statement builders into the repositories by provider level. Below is the sample way on how to do it.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">StatementBuilderMapper</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">OracleConnection</span><span class="p">),</span> <span class="k">new</span> <span class="n">OracleStatementBuilder</span><span class="p">());</span>
<span class="n">StatementBuilderMapper</span><span class="p">.</span><span class="n">Map</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">OleDbConnection</span><span class="p">),</span> <span class="k">new</span> <span class="n">OleDbStatementBuilder</span><span class="p">());</span>
</pre></div>
</div>
<p>The object <cite>StatementBuilderMapper.Map</cite> is callable everywhere in the application as it was implemented in s static way. Make sure to call it once, or else, an exception will be thrown.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to RepoDb</a><ul>
<li><a class="reference internal" href="#goal">Goal</a></li>
<li><a class="reference internal" href="#principles">Principles</a></li>
<li><a class="reference internal" href="#why-repodb">Why RepoDb?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation-steps">Installation Steps</a><ul>
<li><a class="reference internal" href="#via-nuget-package-manager">Via Nuget Package Manager</a></li>
<li><a class="reference internal" href="#via-package-manager-console">Via Package Manager Console</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-dataentity">Creating a DataEntity</a><ul>
<li><a class="reference internal" href="#dataentity-class">DataEntity Class</a></li>
<li><a class="reference internal" href="#idataentity-interface">IDataEntity Interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mapping-with-mapattribute">Mapping with MapAttribute</a><ul>
<li><a class="reference internal" href="#mapping-a-class">Mapping a Class</a></li>
<li><a class="reference internal" href="#mapping-a-property">Mapping a Property</a></li>
</ul>
</li>
<li><a class="reference internal" href="#primary-attribute">Primary Attribute</a><ul>
<li><a class="reference internal" href="#defining-an-identity-property">Defining an Identity Property</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ignore-attribute">Ignore Attribute</a></li>
<li><a class="reference internal" href="#multiple-entity-mapping">Multiple Entity Mapping</a></li>
<li><a class="reference internal" href="#type-mapping">Type Mapping</a></li>
<li><a class="reference internal" href="#working-wth-repository">Working wth Repository</a><ul>
<li><a class="reference internal" href="#dbrepository-class">DbRepository Class</a></li>
<li><a class="reference internal" href="#baserepository-class">BaseRepository Class</a></li>
<li><a class="reference internal" href="#creating-a-connection">Creating a Connection</a></li>
<li><a class="reference internal" href="#connection-ensureopen">Connection.EnsureOpen</a></li>
<li><a class="reference internal" href="#connection-executereader">Connection.ExecuteReader</a></li>
<li><a class="reference internal" href="#connection-executequery">Connection.ExecuteQuery</a></li>
<li><a class="reference internal" href="#connection-executenonquery">Connection.ExecuteNonQuery</a></li>
<li><a class="reference internal" href="#connection-executescalar">Connection.ExecuteScalar</a></li>
<li><a class="reference internal" href="#working-with-storedprocedure">Working with StoredProcedure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transaction">Transaction</a></li>
<li><a class="reference internal" href="#expression-tree">Expression Tree</a><ul>
<li><a class="reference internal" href="#explicit-query-expression">Explicit Query Expression</a></li>
<li><a class="reference internal" href="#dynamic-query-expression">Dynamic Query Expression</a></li>
</ul>
</li>
<li><a class="reference internal" href="#querygroup">QueryGroup</a><ul>
<li><a class="reference internal" href="#query-operations">Query Operations</a></li>
<li><a class="reference internal" href="#operation-equal">Operation.Equal</a></li>
<li><a class="reference internal" href="#operation-notequal">Operation.NotEqual</a></li>
<li><a class="reference internal" href="#operation-lessthan">Operation.LessThan</a></li>
<li><a class="reference internal" href="#operation-greaterthan">Operation.GreaterThan</a></li>
<li><a class="reference internal" href="#operation-lessthanorequal">Operation.LessThanOrEqual</a></li>
<li><a class="reference internal" href="#operation-greaterthanorequal">Operation.GreaterThanOrEqual</a></li>
<li><a class="reference internal" href="#operation-like">Operation.Like</a></li>
<li><a class="reference internal" href="#operation-notlike">Operation.NotLike</a></li>
<li><a class="reference internal" href="#operation-between">Operation.Between</a></li>
<li><a class="reference internal" href="#operation-notbetween">Operation.NotBetween</a></li>
<li><a class="reference internal" href="#operation-in">Operation.In</a></li>
<li><a class="reference internal" href="#operation-notin">Operation.NotIn</a></li>
<li><a class="reference internal" href="#operation-all">Operation.All</a></li>
<li><a class="reference internal" href="#operation-any">Operation.Any</a></li>
</ul>
</li>
<li><a class="reference internal" href="#repository-operations">Repository Operations</a><ul>
<li><a class="reference internal" href="#query-operation">Query Operation</a><ul>
<li><a class="reference internal" href="#ordering-a-query">Ordering a Query</a></li>
<li><a class="reference internal" href="#limiting-a-query-result">Limiting a Query Result</a></li>
</ul>
</li>
<li><a class="reference internal" href="#insert-operation">Insert Operation</a></li>
<li><a class="reference internal" href="#update-operation">Update Operation</a></li>
<li><a class="reference internal" href="#delete-operation">Delete Operation</a></li>
<li><a class="reference internal" href="#merge-operation">Merge Operation</a></li>
<li><a class="reference internal" href="#inlineupdate-operation">InlineUpdate Operation</a></li>
<li><a class="reference internal" href="#bulkinsert-operation">BulkInsert Operation</a></li>
<li><a class="reference internal" href="#count-and-countbig-operation">Count and CountBig Operation</a></li>
<li><a class="reference internal" href="#batchquery-operation">BatchQuery Operation</a></li>
<li><a class="reference internal" href="#executequery-operation">ExecuteQuery Operation</a></li>
<li><a class="reference internal" href="#executenonquery-operation">ExecuteNonQuery Operation</a></li>
<li><a class="reference internal" href="#executescalar-operation">ExecuteScalar Operation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-cache">Working with Cache</a><ul>
<li><a class="reference internal" href="#creating-a-cache-entry">Creating a Cache Entry</a></li>
<li><a class="reference internal" href="#checking-a-cache-entry">Checking a Cache Entry</a></li>
<li><a class="reference internal" href="#iterating-the-cache-entries">Iterating the Cache Entries</a></li>
<li><a class="reference internal" href="#removing-or-clearing-a-cache">Removing or Clearing a Cache</a></li>
<li><a class="reference internal" href="#injecting-a-custom-cache-object">Injecting a Custom Cache Object</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-trace">Working with Trace</a><ul>
<li><a class="reference internal" href="#itrace-interface">ITrace Interface</a></li>
<li><a class="reference internal" href="#itracelog-interface">ITraceLog Interface</a></li>
<li><a class="reference internal" href="#icancellabletracelog-interface">ICancellableTraceLog Interface</a></li>
<li><a class="reference internal" href="#creating-a-custom-trace-object">Creating a Custom Trace Object</a></li>
<li><a class="reference internal" href="#canceling-an-operation">Canceling an Operation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-statementbuilder">Working with StatementBuilder</a><ul>
<li><a class="reference internal" href="#querybuilder-object">QueryBuilder Object</a></li>
<li><a class="reference internal" href="#createbatchquery-method">CreateBatchQuery Method</a></li>
<li><a class="reference internal" href="#createcount-method">CreateCount Method</a></li>
<li><a class="reference internal" href="#createcountbig-method">CreateCountBig Method</a></li>
<li><a class="reference internal" href="#createdelete-method">CreateDelete Method</a></li>
<li><a class="reference internal" href="#createinlineupdate-method">CreateInlineUpdate Method</a></li>
<li><a class="reference internal" href="#createinsert-method">CreateInsert Method</a></li>
<li><a class="reference internal" href="#createmerge-method">CreateMerge Method</a></li>
<li><a class="reference internal" href="#createquery-method">CreateQuery Method</a></li>
<li><a class="reference internal" href="#createupdate-method">CreateUpdate Method</a></li>
<li><a class="reference internal" href="#creating-a-custom-statement-builder">Creating a custom Statement Builder</a></li>
<li><a class="reference internal" href="#mapping-a-statement-builder">Mapping a Statement Builder</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Michael Camara Pendon.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>